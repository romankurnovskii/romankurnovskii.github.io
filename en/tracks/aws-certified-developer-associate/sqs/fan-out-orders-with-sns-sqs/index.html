<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo "><title>Fan-Out Orders using Amazon SNS and SQS | Roman Kurnovskii</title><meta property="og:title" content="Fan-Out Orders using Amazon SNS and SQS | Roman Kurnovskii"><meta property="og:type" content="article"><meta property="og:image" content="https://romankurnovskii.com/images/icon.png"><meta property="og:url" content="https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/fan-out-orders-with-sns-sqs/"><meta property="og:description" content="Fan-Out Orders using Amazon SNS and SQS"><meta property="og:locale" content="en"><meta property="og:site_name" content="Roman Kurnovskii"><meta property="article:published_time" content="2022-07-06T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-11T09:25:30+02:00"><meta property="article:section" content="tracks"><link rel=icon type=image/png sizes=32x32 href=https://romankurnovskii.com/images/icon_huc02d7296c9eb9353758cb2467c0d17b0_10773_32x32_fill_box_center_3.png><link rel=apple-touch-icon sizes=180x180 href=https://romankurnovskii.com/images/icon_huc02d7296c9eb9353758cb2467c0d17b0_10773_180x180_fill_box_center_3.png><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css rel=stylesheet crossorigin=anonymous><script src=https://unpkg.com/flowbite@1.5.1/dist/flowbite.js></script>
<script src=https://unpkg.com/axios@0.27.2/dist/axios.min.js></script>
<script src=https://unpkg.com/lunr@2.3.9/lunr.min.js></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" media=print onload='this.media="all",this.onload=null' crossorigin><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js integrity=" sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" defer crossorigin></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600&display=swap" rel=stylesheet><link rel=stylesheet href=https://romankurnovskii.com/css/yalla.min.fb19244877382900ab3b6152f08adfeb0298a8bc00309667de678ae533dd761943bf6e7309eec55944b2a4435d7a4a30.css><script defer src=https://romankurnovskii.com/js/yalla.min.c10f88fac8e0f4c2c802131741be30a1f629861cc319c52238e2685191e08f721da37a6696906f314554e1ec7423f51c.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css media=print onload='this.media="all",this.onload=null' crossorigin><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js crossorigin></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js crossorigin></script><meta name=description content="Fan-Out Orders using Amazon SNS and SQS"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Roadmaps","item":"https://romankurnovskii.com/en/tracks/"},{"@type":"ListItem","position":2,"name":"AWS Certified Developer (DVA-C01 -\u003e DVA-C02)","item":"https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/"},{"@type":"ListItem","position":3,"name":"Simple Queue Service","item":"https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/"},{"@type":"ListItem","position":4,"name":"Fan-Out Orders using Amazon SNS and SQS","item":"https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/fan-out-orders-with-sns-sqs/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/fan-out-orders-with-sns-sqs/"},"headline":"Fan-Out Orders using Amazon SNS and SQS | Roman Kurnovskii","datePublished":"2022-07-06T00:00:00+00:00","dateModified":"2023-02-11T09:25:30+02:00","wordCount":1629,"publisher":{"@type":"Person","name":"Roman Kurnovskii","logo":{"@type":"ImageObject","url":"https://romankurnovskii.com/images/icon.png"}},"description":"Fan-Out Orders using Amazon SNS and SQS"}</script><link rel=preconnect href=https://www.google-analytics.com crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-26F2C5ZR4Y"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-26F2C5ZR4Y")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js?v2","ym"),ym(87734724,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/87734724 style=position:absolute;left:-9999px alt></div></noscript><script>let storageColorScheme=localStorage.getItem("lightDarkMode");const isDark2=JSON.parse(localStorage.getItem("DarkMode")||"false");isDark2?storageColorScheme="Dark":storageColorScheme="Light",((storageColorScheme=="Auto"||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches||storageColorScheme=="Dark")&&document.getElementsByTagName("html")[0].classList.add("dark")</script></head><body class="flex min-h-screen flex-col"><header><div class="mx-auto w-full max-w-screen-xl"><nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0"><button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="open mobile menu">
<i class="fas fa-bars"></i></button>
<a href=/en class="me-6 text-primary-text text-xl font-bold">Roman Kurnovskii</a><div id=mobile-burger-menu class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20"><ul id=menu><li class=parent><a href=/en/posts/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Notes</a><ul class=child><li class=parent><a href=/en/categories/aws/>AWS <span class=expand>»</span></a><ul class=child><li class=parent><a href=/en/tracks/aws-certified-developer-associate/>AWS Developer Associate</a></li></ul></li><li class=parent><a href=/en/categories/os/>OS <span class=expand>»</span></a><ul class=child><li class=parent><a href=/en/categories/docker/>Docker</a></li><li class=parent><a href=/en/categories/linux/>Linux</a></li><li class=parent><a href=/en/categories/macos/>Mac</a></li></ul></li><li class=parent><a href=/en/categories/programming/>Programming <span class=expand>»</span></a><ul class=child><li class=parent><a href=/en/tracks/algorithms-101/>Algorithms</a></li><li class=parent><a href=/en/categories/hugo/>Hugo</a></li><li class=parent><a href=/en/categories/javascript/>JavaScript</a></li><li class=parent><a href=/en/categories/python/>Python</a></li></ul></li><li><a href=/en/categories/cheatsheet/>Cheat Sheets</a></li><li><a href=/en/p/links/>Links</a></li></ul></li><li class=parent><a href=/en/categories/roadmaps/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Roadmaps</a><ul class=child><li><a href=/en/tracks/algorithms-101/>Algorithms101</a></li><li><a href=/en/tracks/aws-certified-developer-associate/>AWS Developer Associate</a></li><li><a href=/ru/tracks/disser/>Диссертация [RU]</a></li></ul></li><li class=parent><a href=/en/apps/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Apps</a></li></ul></div><div class=flex><div class="relative pt-4 md:pt-0"><form id=search class="flex items-center"><label for=search-input class=sr-only>Search</label><div class="relative w-full"><input type=text type=search id=search-input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder=Search required></div></form></div><div class="relative pt-4 ps-2 md:pt-0"><button class="p-1 rounded border dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-700" onclick='location.href="/en/search/"'>
<img width=13 src=https://img.icons8.com/ios-glyphs/30/null/search-more.png></button></div></div></nav></div><div id=is-open-mobile class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0"></div><script>document.addEventListener("DOMContentLoaded",()=>{switchMobileMenuBurger()})</script></header><main class="grow pt-16"><div class=pl-scrollbar><div class="mx-auto w-full max-w-screen-2xl lg:px-2 xl:px-4"><div class=lg:pt-8><div class="flex flex-col md:flex-row bg-secondary-bg rounded"><div class="md:w-1/4 lg:w-1/5 border-e"><div class="sticky mt-12"><div id=sidebar-title class="md:hidden mx-4 px-2 pt-4 pb-2 md:border-b text-tertiary-text md:text-primary-text"><span class=font-semibold>Table of Contents</span>
<i class='fas fa-caret-right ms-1'></i></div><div id=sidebar-toc class="hidden overflow-y-auto md:block mx-6 md:mx-0 pe-2 pt-2 md:max-h-doc-sidebar bg-primary-bg md:bg-transparent"><div class="flex flex-wrap ms-1 -me-2 p-1 bg-secondary-bg md:bg-primary-bg rounded"><a class=hover:text-yalla href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/>AWS Certified Developer (DVA-C01 -> DVA-C02)</a></div><aside aria-label=Sidebar><div class="py-2 px-1"><ul id=doc__nav__sidebar class=space-y-1><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/iam/><span>IAM</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/ec2/><span>EC2</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticbeanstalk/><span>Elastic Beanstalk</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/lambda/><span>Lambda</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/>S3</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/create-s3-bucket/><span>Create S3 Bucket</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/create-folder-s3/><span>Create a folder inside S3 Bucket</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/upload-file-to-s3/><span>Upload a file to S3</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/grant-access-s3/><span>Grant public access to S3 Object</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/how-to-change-metadata-s3/><span>Change metadata of S3 Object</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/s3/delete-from-s3/><span>Delete S3 Bucket</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/dynamodb/>DynamoDB</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/dynamodb/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/dynamodb/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/dynamodb/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/dynamodb/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/dynamodb/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/dynamodb/introduction-dynamodb/><span>Introduction to DynamoDB</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticache/><span>ElastiCache</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/rds/><span>RDS</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/api-gateway/><span>API Gateway</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudfront/>CloudFront</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudfront/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudfront/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudfront/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudfront/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudfront/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudfront/configuring-static-website-s3-and-cloudfront/><span>Configuring a Static Website With S3 And CloudFront</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticloadbalancing/>Elastic Load Balancing</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticloadbalancing/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticloadbalancing/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticloadbalancing/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticloadbalancing/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticloadbalancing/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/elasticloadbalancing/create-amazon-load-balancing/><span>Create Classic Load Balancer</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kinesis/>Kinesis</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kinesis/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kinesis/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kinesis/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kinesis/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kinesis/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kinesis/sessionizing-clickstream-data-kinesis-data-analytics/><span>Sessionizing Clickstream Data with Amazon Kinesis Data Analytics</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/opensearch-service/>OpenSearch Service</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/opensearch-service/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/opensearch-service/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/opensearch-service/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/opensearch-service/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/opensearch-service/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/opensearch-service/build-log-aggregation-system/><span>Build A Log Aggregation System in AWS</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudwatch/>CloudWatch</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudwatch/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudwatch/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudwatch/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudwatch/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudwatch/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudwatch/introduction-to-cloudwatch/><span>Introduction to CloudWatch</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudformation/>CloudFormation</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudformation/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudformation/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudformation/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudformation/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudformation/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cloudformation/initializing-ec2-with-cloudformation/><span>Initializing Amazon EC2 Instances with AWS CloudFormation Init</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codecommit/>CodeCommit</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codecommit/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codecommit/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codecommit/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codecommit/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codecommit/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codecommit/introduction-codecommit/><span>Introduction to CodeCommit</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codedeploy/><span>CodeDeploy</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codebuild/><span>CodeBuild</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codepipeline/><span>CodePipeline</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codeguru/>CodeGuru</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codeguru/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codeguru/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codeguru/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codeguru/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codeguru/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codeguru/automating-code-reviews-amazon-codeguru/><span>Automating Code Reviews with Amazon CodeGuru</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codestar/>CodeStar</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codestar/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codestar/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codestar/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codestar/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codestar/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codestar/develop-and-deploy-app-with-codestar/><span>Develop and Deploy an Application with AWS CodeStar</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/codeartifact/><span>CodeArtifact</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/xray/><span>X-Ray</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/fis/><span>Fault Injection Simulator</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/ecr/><span>Elastic Container Registry</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/ecs/><span>Elastic Container Service</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/fargate/><span>Fargate</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/eks/><span>Elastic Kubernetes Service</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/cognito/><span>Cognito</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/route53/><span>Route 53</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kms/>Key Management Service</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kms/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kms/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kms/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kms/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kms/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/kms/encrypting-s3-objects-using-sse-kms/><span>Encrypting S3 Objects Using SSE-KMS</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/eventbridge/><span>EventBridge</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sns/>Simple Notification Service</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sns/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sns/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sns/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sns/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sns/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sns/aws-lambda-sns-notifications/><span>Process Amazon SNS Notifications with AWS Lambda</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/>Simple Queue Service</a>
<button type=button aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/ data-collapse-toggle=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/></i></button></div><ul id=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/ class=ml-3><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/fan-out-orders-with-sns-sqs/ class=bg-tertiary-bg><span>Fan-Out Orders using Amazon SNS and SQS</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/step-functions/><span>Step Functions</span></a></li><li><a href=https://romankurnovskii.com/en/tracks/aws-certified-developer-associate/questions/><span>Questions</span></a></li></ul></div></aside></div></div></div><div class="w-full md:w-3/4 lg:w-4/5 pb-2 pt-2 md:pt-2"><div class=flex><div class="w-full lg:w-3/4 px-6"><article class=prose><h1>Fan-Out Orders using Amazon SNS and SQS</h1><div class="text-tertiary-text text-sm not-prose mt-2 flex flex-row flex-wrap items-center"><div class=me-4><i class="fa-regular fa-calendar-days"></i>
<span>Updated: 2023-02-11</span></div><div class=me-4><i class="fa-regular fa-clock"></i>
<span>8 min read</span></div><div id=page__views__div class="me-4 my-2"><i class="fa-regular fa-eye me-1"></i>
<span id=page__views></span></div></div><div class="block lg:hidden"><h3 class=text-lg>On This Page</h3><div class=break-words><nav id=TableOfContents><ul><li><a href=#lab>Lab</a></li><li><a href=#creating-an-amazon-sns-topic-and-amazon-sqs-queues>Creating an Amazon SNS Topic and Amazon SQS Queues</a></li><li><a href=#connecting-to-the-virtual-machine-using-ec2-instance-connect>Connecting to the Virtual Machine using EC2 Instance Connect</a></li><li><a href=#publishing-and-processing-messages>Publishing and Processing Messages</a></li></ul></nav></div></div><h2 id=lab>Lab</h2><ul><li><a href=https://cloudacademy.com/lab/fan-out-orders-with-sns-sqs/>Fan-Out Orders using Amazon SNS and SQS</a></li></ul><h2 id=creating-an-amazon-sns-topic-and-amazon-sqs-queues>Creating an Amazon SNS Topic and Amazon SQS Queues</h2><p>Here&rsquo;s a diagram of what you will build and configure in this lab step:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/sqs-sns-diagram.png id=zoom-default alt=alt loading=lazy></p></p><ol><li>In the search bar at the top, enter <em>SNS</em> and under <strong>Services</strong>, click the <strong>Simple Notification Service</strong> result:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220426144130-1-4c7fe27f-244d-4810-b3fd-d902f54522d5.png id=zoom-default alt=alt loading=lazy></p></p><ol start=2><li>In the <strong>Create topic</strong> card on the right, in the <strong>Topic name</strong> textbox, enter <em>new-orders</em> and click <strong>Next step</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-10-11-30-29.png id=zoom-default alt=alt loading=lazy></p></p><p>The <strong>Create topic</strong> form will load.</p><p>By default, the <strong>Type</strong> of topic selected will be <strong>Standard</strong>. This is the most scalable topic type. The cost of this scalability is that message order and exactly-once delivery attempts can not be guaranteed.</p><p>If you are building a solution requires strict message ordering and exactly-once message delivery, you should use a <strong>FIFO</strong> type topic.</p><p>Standard is fine for this lab.</p><ol start=3><li>Click the black triangle next to <strong>Access policy - optional</strong> to expand the section:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-10-16-46-44.png id=zoom-default alt=alt loading=lazy></p></p><ol start=4><li>In the <strong>Access policy</strong> section, under <strong>Define who can publish messages to the topic</strong>, select <strong>Everyone</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-10-16-45-42.png id=zoom-default alt=alt loading=lazy></p></p><ol start=5><li>Under <strong>Define who can subscribe to this topic</strong>, select <strong>Everyone</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-10-16-49-14.png id=zoom-default alt=alt loading=lazy></p></p><p>You are using a permissive access policy to save time and because the focus of this lab is on demonstrating the fan-out scenario.</p><p>In a non-lab environment, you should carefully consider the access policy required and make sure if conforms with your company or organization&rsquo;s security requirements.</p><ol start=6><li>Scroll to the bottom of the page, and click <strong>Create topic</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-07-16-00-00.png id=zoom-default alt=alt loading=lazy></p></p><p>You will see a page load displaying details of your newly created topic:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-07-16-04-56.png id=zoom-default alt=alt loading=lazy></p></p><p>In the order processing system your are building, this Amazon SNS topic is where orders are published to. In a non-lab environment it would most likely be a web application or other application that accepts orders that will publish messages to this topic.</p><p>Next, you will create two queues using Amazon Simple Queue Service and subscribe them to your Amazon SNS topic.</p><ol start=7><li>Open a new tab by right-clicking the <strong>AWS</strong> icon in the top-left and selecting <strong>Open in new tab</strong>.</li></ol><p><em>Note</em>: The above instruction may vary slightly depending upon the web browser you are using.</p><ol start=8><li>In the search bar at the top, enter <em>SQS</em>, and under <strong>Services</strong>, click the <strong>Simple Queue Service</strong> result:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220426144410-2-7b2e9397-ec0d-4c43-a3fc-77a09521631a.png id=zoom-default alt=alt loading=lazy></p></p><ol start=9><li>In the middle right of the screen, in the <strong>Get started</strong> card, click <strong>Create queue</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220426144524-4-a1c1d8c4-cee5-4003-afc8-be7765549203.png id=zoom-default alt=alt loading=lazy></p></p><p>The <strong>Create queue</strong> form will open.</p><ol start=10><li>In the <strong>Name</strong> textbox, enter <em>orders-for-inventory</em>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-07-16-23-37.png id=zoom-default alt=alt loading=lazy></p></p><ol start=11><li>Scroll down to the bottom, click <strong>Create queue</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220426144522-3-fce05280-aad4-4c48-b5fd-76c17519d63e.png id=zoom-default alt=alt loading=lazy></p></p><p>You will see a web page load showing you details of your newly created Amazon SQS queue:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-07-16-25-11.png id=zoom-default alt=alt loading=lazy></p></p><p>You will now create a second Amazon SQS queue for analytics.</p><ol start=12><li>To navigate to the <strong>Queues</strong> list page, at the top-left, click <strong>Queues</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-07-16-27-02.png id=zoom-default alt=alt loading=lazy></p></p><ol start=13><li><p>On the right-hand side, click <strong>Create queue</strong>.</p></li><li><p>Repeat the queue creation process, only this time enter <em>orders-for-analytics</em> as the <strong>Name</strong> of the queue.</p></li><li><p>Return to the <strong>Queues</strong> list page by clicking <strong>Queues</strong> in the top-left.</p></li></ol><p>You will see the two queues you have created:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-07-16-31-46.png id=zoom-default alt=alt loading=lazy></p></p><ol start=16><li><p>Click the radio button for the <strong>orders-for-analytics</strong> queue.</p></li><li><p>On the right-hand side, click <strong>Actions</strong> and click <strong>Subscribe to Amazon SNS topic</strong>:</p></li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220426144713-5-e21eee24-b047-4cbd-8c64-14e86600608f.png id=zoom-default alt=alt loading=lazy></p></p><p>The <strong>Subscribe to Amazon SNS topic</strong> form will load.</p><ol start=18><li>In the <strong>Choose a topic</strong> drop down, select the topic ending with <strong>new-orders</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/1_creating-sns-topic-and-sqs-queues/assets/2021-05-07-16-34-24.png id=zoom-default alt=alt loading=lazy></p></p><p>This is the Amazon SNS topic you created earlier.</p><ol start=19><li><p>Click <strong>Save</strong> to finish subscribing this queue to your topic.</p></li><li><p>At the top-left, click <strong>Queues</strong> again.</p></li><li><p>Repeat the topic subscription process for your <strong>orders-for-inventory</strong> Amazon SQS queue.</p></li></ol><p>You now have both of your Amazon SQS queues subscribed to your Amazon SNS topic. Any messages published to the topic will fan-out to both queues.</p><h2 id=connecting-to-the-virtual-machine-using-ec2-instance-connect>Connecting to the Virtual Machine using EC2 Instance Connect</h2><p>1. In the AWS Management Console search bar, enter <em>EC2</em>, and click the <strong>EC2</strong> result under <strong>Services</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220222123231-1-d93dcbbf-c7a6-4e7d-9466-d70014660d6b.png id=zoom-default alt=alt loading=lazy></p></p><p>2. To see available instances, click <strong>Instances</strong> in the left-hand menu:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid1-ae56f48d-6e5e-4414-a899-7a7ee4c156b0.png id=zoom-default alt=alt loading=lazy></p></p><p>The instances list page will open, and you will see an instance named <strong>cloudacademylabs</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220208101137-2-36b4b73c-f199-4ce6-b85b-a1bd90ae3819.png id=zoom-default alt=alt loading=lazy></p></p><p>If you don&rsquo;t see a running instance then the lab environment is still loading. Wait until the <strong>Instance state</strong> is <strong>Running</strong>.</p><p>3. Right-click the <strong>cloudacademylabs</strong> instance, and click <strong>Connect</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220128094104-2-a2d50c2a-05c8-442c-acc0-4c02dd6c4e38.png id=zoom-default alt=alt loading=lazy></p></p><p>The <strong>Connect to your instance</strong> form will load.</p><p>4. In the form, ensure the <strong>EC2 Instance Connect</strong> tab is selected:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-bdf76eab-5bef-415f-bdee-f1ef97330f62.png id=zoom-default alt=alt loading=lazy></p></p><p>You will see the instance&rsquo;s <strong>Instance ID</strong> and <strong>Public IP address</strong> displayed.</p><p>5. In the <strong>User name</strong> textbox, enter <em>ec2-user</em>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-ccba4473-690f-4589-9542-7fff1354f72f.png id=zoom-default alt=alt loading=lazy></p></p><p><em>Note</em>: Ensure there is no space after ec2-user or connect will fail. </p><p>6. To open a browser-based shell, click <strong>Connect</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-f687e238-2010-4e45-b747-763c96e50035.png id=zoom-default alt=alt loading=lazy></p></p><p>If you see an error it&rsquo;s likely that the environment hasn&rsquo;t finished setting up. Check for <strong>Setup completed</strong> at the top-left corner of the lab and try connecting again:</p><p><p class=md__image><img src=https://assets.labs.cloudacademy.com/content/images/setup/OpenEnvironment.png id=zoom-default alt=alt loading=lazy></p></p><p>A browser-based shell will open in a new window ready for you to use.</p><p>Keep this window open, you will use it in later lab steps.</p><p>You can also connect to the instance using your preferred SSH client and the PPK (Windows) or PEM (Mac/Linux) key files in the <strong>Credentials</strong> section of this lab.</p><h2 id=publishing-and-processing-messages>Publishing and Processing Messages</h2><ol><li>In the terminal, enter the following command:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>aws sns list-topics
</span></span></code></pre></div><p>You will see one topic displayed:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220426144936-6-72776ae9-6c41-445c-8b0e-68a652adfc47.png id=zoom-default alt=alt loading=lazy></p></p><p><em>Note</em>: Your <strong>TopicArn</strong> will have a different account identifier.</p><p>By default, the AWS command-line interface tool uses the JSON format for responses. This response contains an array of <strong>Topics</strong> with one element. The element consists of a <strong>TopicArn</strong>.</p><p><strong>Arn</strong> is short for Amazon Resource Name. An ARN is used to uniquely identify resources in AWS.</p><p>In this lab, the EC2 instance has been configured with an IAM role that has permissions to interact with Amazon SNS topics and Amazon SQS queues.</p><ol start=2><li>Store the value of the <strong>TopicArn</strong> attribute in a shell variable (<code>topic_arn</code>):</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>topic_arn=$(aws sns list-topics --query &#39;Topics[0].TopicArn&#39; --output text)
</span></span></code></pre></div><p>The above command uses the <code>--query</code> option to select only the value of the TopicArn and the <code>--output</code> option is used to specify plaintext format which removes the quotation marks from the value.</p><ol start=3><li>To publish a message, enter the following, utilizing the ARN you stored in the <code>topic_arn</code> shell variable:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>aws sns publish \
</span></span><span style=display:flex><span>--topic-arn $topic_arn \
</span></span><span style=display:flex><span>--message  &#34;1 x Widget @ 21.99 USD\n2 x Widget Cables @ 5.99 USD&#34;
</span></span></code></pre></div><p>In response, you will see a <strong>MessageId</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/2_publishing-and-receiving-messages/assets/2021-05-10-15-20-23.png id=zoom-default alt=alt loading=lazy></p></p><p><em>Note</em>: Your message identifier will be different.</p><p>You have successfully published an order message to your Amazon Simple Notification Service topic.</p><p>In this lab, you are using the AWS command-line interface tool to simulate an application publishing an order message.</p><p>In a non-lab environment, the message could be published by a web application that accepts orders from customers.</p><ol start=4><li>To list Amazon Simple Queue Service queues, enter the following command:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>aws sqs list-queues
</span></span></code></pre></div><p>You will see a JSON response:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/2_publishing-and-receiving-messages/assets/2021-05-10-16-10-37.png id=zoom-default alt=alt loading=lazy></p></p><p>The queues that you created earlier are listed.</p><ol start=5><li>Store each of the <strong>QueueUrls</strong> in shell variables:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>analytics_queue_url=$(aws sqs list-queues --query &#39;QueueUrls[0]&#39; --output text)
</span></span><span style=display:flex><span>inventory_queue_url=$(aws sqs list-queues --query &#39;QueueUrls[1]&#39; --output text)
</span></span></code></pre></div><ol start=6><li>To retrieve a message from the <strong>orders-for-analytics</strong> queue, enter the following command, utilizing the analytics queue URL you stored previously:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>aws sqs receive-message \
</span></span><span style=display:flex><span>    --queue-url $analytics_queue_url
</span></span></code></pre></div><p>You will see a JSON response containing an array with one <strong>Message</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/2_publishing-and-receiving-messages/assets/2021-05-10-16-58-44.png id=zoom-default alt=alt loading=lazy></p></p><p>The response contains the following fields:</p><ul><li><strong>Body</strong>: A JSON representation of the message</li><li><strong>ReceiptHandle</strong>: You are required to supply this to delete a message after processing</li><li><strong>MD5OfBody</strong>: An MD5 hash of the message body</li><li><strong>MessageId</strong>: The message identifier that Amazon SNS saw when pushing the message to the queues<ul><li>Note that this is not the same as the <strong>MessageId</strong> that Amazon SNS returned to you when you published to the topic</li></ul></li></ul><ol start=7><li>Repeat the previous instruction, using the <strong>orders-for-inventory</strong> queue but store the message response in a shell variable (for use later) and output the shell variable (using Python&rsquo;s JSON tool to pretty print it):</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>inventory_message=$(aws sqs receive-message --queue-url $inventory_queue_url)
</span></span><span style=display:flex><span>echo $inventory_message | python -m json.tool
</span></span></code></pre></div><p>You will see the same message displayed again.</p><p>The message you published to the Amazon SNS topic has been sent to the Amazon SQS queues you subscribed the topic. This is an example of fanning out a message to multiple receivers.</p><p>In a non-lab environment, you could have worker applications constantly running and asking the Amazon SQS queues for more messages. One worker may be updating an inventory database for the order, whilst another worker could be recording the order details in a data lake for future analysis.</p><p>Using Amazon SNS and Amazon SQS like this allows you to build scalable systems that are decoupled and resilient. If a worker went offline, messages would queue up in the Amazon SQS queues. When the worker is available again, it can pick up new messages where it left off.</p><p>You can also have multiple worker applications, to help ensure there&rsquo;s no downtime in message processing.</p><p>After successfully processing a message, a worker application should delete the message to prevent it from being processed again.</p><ol start=8><li>Store the value of the <strong>ReceiptHandle</strong> attribute in a shell variable:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>receipt_handle=$(echo $inventory_message | python -m json.tool | grep ReceiptHandle | cut -d\&#34; -f 4)
</span></span></code></pre></div><ol start=9><li>To delete a message, enter the following command for the <strong>orders-for-inventory</strong> queue:</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>aws sqs delete-message \
</span></span><span style=display:flex><span>    --queue-url $inventory_queue_url \
</span></span><span style=display:flex><span>    --receipt-handle $receipt_handle
</span></span></code></pre></div><ol start=10><li>Return to your browser tab with the Amazon SQS management console open.</li></ol><p><em>Note</em>: If the SQS management console appears to only have one SQS queue, click the refresh button above the table:<br><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid1-e8f78050-27a8-4f4e-8238-1ec65fac403b.png id=zoom-default alt=alt loading=lazy></p><br>The correct number of SQS queues will be displayed after a refresh.</p><ol start=11><li><p>Navigate to the <strong>Queues</strong> list and click the <strong>orders-for-inventory</strong> queue.</p></li><li><p>In the top-right, click <strong>Send and receive messages</strong>:</p></li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/2_publishing-and-receiving-messages/assets/2021-05-11-12-56-38.png id=zoom-default alt=alt loading=lazy></p></p><ol start=13><li>Verify that in that <strong>Receive messages</strong> section, under <strong>Messages available</strong>, it says <strong>0</strong>.</li></ol><p>This is the queue you deleted a message for, simulating a long-running background application that receives an Amazon SQS message and then deletes the message after processing.</p><ol start=14><li>Repeat the last three instructions for the <strong>orders-for-analytics</strong> queue and verify <strong>Messages available</strong> is <strong>1</strong>:</li></ol><p><p class=md__image><img src=https://assets.cloudacademy.com/labs/uploads/fan-out-orders-with-sns-sqs//steps/2_publishing-and-receiving-messages/assets/2021-05-11-13-00-29.png id=zoom-default alt=alt loading=lazy></p></p><p>This is the queue you did not delete the message for. The message is still available to be picked up for processing by an application receiving messages from the queue.</p></article><div id=open_comments_block></div><script src=/opencomments.js renderdivid=open_comments_block server=https://eyt4njm3se.execute-api.eu-west-1.amazonaws.com/comments awstag defer></script></div><div class="hidden lg:block lg:w-1/4"><div class="bg-primary-bg prose sticky top-7 z-10 hidden
px-6 lg:block"><h3 class=text-lg>On This Page</h3></div><div class="sticky-toc hidden px-0 pb-6 lg:block"><nav id=TableOfContents><ul><li><a href=#lab>Lab</a></li><li><a href=#creating-an-amazon-sns-topic-and-amazon-sqs-queues>Creating an Amazon SNS Topic and Amazon SQS Queues</a></li><li><a href=#connecting-to-the-virtual-machine-using-ec2-instance-connect>Connecting to the Virtual Machine using EC2 Instance Connect</a></li><li><a href=#publishing-and-processing-messages>Publishing and Processing Messages</a></li></ul></nav><div class="feedback-links mt-4 text-sm"><hr><div><a href=https://github.com/romankurnovskii/romankurnovskii.github.io/edit/main/content/tracks/aws-certified-developer-associate/sqs/fan-out-orders-with-sns-sqs/index.en.md title="Edit this page" target=_blank><i class="fas fa-edit me-1"></i>
<span>Edit this page</span></a></div><div><a href="https://github.com/romankurnovskii/romankurnovskii.github.io/issues/new/?body=File:%20[/content/tracks/aws-certified-developer-associate/sqs/fan-out-orders-with-sns-sqs/index.en.md/]%28/https:/romankurnovskii.com/en/tracks/aws-certified-developer-associate/sqs/fan-out-orders-with-sns-sqs/%29" title="Request issue" target=_blank><i class="fas fa-check me-1" aria-hidden=true></i>
<span>Request page change</span></a></div></div></div><script>window.addEventListener("DOMContentLoaded",()=>{enableStickyToc()})</script></div></div></div></div></div><script>document.addEventListener("DOMContentLoaded",()=>{changeSidebarHeight(),switchDocToc()})</script></div></div></main><footer class=pl-scrollbar><div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b"><p class="text-sm text-tertiary-text">&copy; 2023 <a href=https://romankurnovskii.com>Roman Kurnovskii</a> personal page
&#183;
<a href=https://romankurnovskii.com/en/index.xml target=_blank>RSS</a> &#183;
<a href=https://gohugo.io>Hugo</a> &#183;
Updated <a href=https://github.com/romankurnovskii/romankurnovskii.github.io/commit/40d4080 target=_blank>2023-02-11</a></p></div><script src=/js/lunr.stemmer.support.min.js></script>
<script src=/js/lunr.ru.min.js></script>
<script src=/js/lunr.multi.min.js></script>
<script src=/js/search.js?v2 languagemode=en></script><div id=search-result tabindex=-1 class="overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 max-w-xs" hidden><div class="relative p-4 w-full max-w-xs h-full md:h-auto"><div class="relative bg-white rounded-lg shadow dark:bg-gray-700"><div class=p-6><h3>Search results</h3><div id=popup_search_results class=prose></div></div></div></div></div><script src=/js/search-page.js?v3></script>
<script src=/js/base.js?7 languagemode=en></script></div></footer><script src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js defer></script>
<script src=/js/zoom-image/placeholders.js?4 defer></script>
<script src=/js/zoom-image/index.js?4 defer></script></body></html>