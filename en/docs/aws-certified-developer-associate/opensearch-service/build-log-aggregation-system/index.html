<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo "><title>Build A Log Aggregation System in AWS | AWS Certified Developer (DVA-C01 -> DVA-C02) | Roman Kurnovskii</title><meta property="og:title" content="Build A Log Aggregation System in AWS | AWS Certified Developer (DVA-C01 -> DVA-C02) | Roman Kurnovskii"><meta property="og:type" content="article"><meta property="og:image" content="https://romankurnovskii.com/images/icon.png"><meta property="og:url" content="https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/build-log-aggregation-system/"><meta property="og:description" content="Will create a distributed, scalable log aggregation system within AWS running on Amazon OpenSearch Service. This Log Aggregation System will ingest as much of your CloudWatch log stream events as you want, events generated from AWS EC2 Instances, Lambda functions, Databases, and anything else you want to submit log events from."><meta property="og:locale" content="en"><meta property="og:site_name" content="Roman Kurnovskii"><meta property="article:published_time" content="2022-07-06T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-23T06:21:55+03:00"><meta property="article:section" content="docs"><link rel=icon type=image/png sizes=32x32 href=https://romankurnovskii.com/images/icon_huc02d7296c9eb9353758cb2467c0d17b0_10773_32x32_fill_box_center_3.png><link rel=apple-touch-icon sizes=180x180 href=https://romankurnovskii.com/images/icon_huc02d7296c9eb9353758cb2467c0d17b0_10773_180x180_fill_box_center_3.png><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css rel=stylesheet crossorigin=anonymous><script src=https://unpkg.com/flowbite@1.5.1/dist/flowbite.js></script>
<script src=https://unpkg.com/axios@0.27.2/dist/axios.min.js></script>
<script src=https://unpkg.com/lunr@2.3.9/lunr.min.js></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" media=print onload='this.media="all",this.onload=null' crossorigin><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js integrity=" sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" defer crossorigin></script><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600&display=swap" rel=stylesheet><link rel=stylesheet href=https://romankurnovskii.com/css/yalla.min.c7ec176e8ca18ce892f0d7dd4156de03306c698a683533675776a9c909994c30f4fbe02baed2f6c54ef51f6b8277e88c.css><script defer src=https://romankurnovskii.com/js/yalla.min.c10f88fac8e0f4c2c802131741be30a1f629861cc319c52238e2685191e08f721da37a6696906f314554e1ec7423f51c.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css media=print onload='this.media="all",this.onload=null' crossorigin><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js crossorigin></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js crossorigin></script><meta name=description content="Will create a distributed, scalable log aggregation system within AWS running on Amazon OpenSearch Service. This Log Aggregation System will ingest as much of your CloudWatch log stream events as you want, events generated from AWS EC2 Instances, Lambda functions, Databases, and anything else you want to submit log events from."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Roadmaps","item":"https://romankurnovskii.com/en/docs/"},{"@type":"ListItem","position":2,"name":"AWS Certified Developer (DVA-C01 -\u003e DVA-C02)","item":"https://romankurnovskii.com/en/docs/aws-certified-developer-associate/"},{"@type":"ListItem","position":3,"name":"OpenSearch Service","item":"https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/"},{"@type":"ListItem","position":4,"name":"Build A Log Aggregation System in AWS","item":"https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/build-log-aggregation-system/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/build-log-aggregation-system/"},"headline":"Build A Log Aggregation System in AWS | AWS Certified Developer (DVA-C01 -\u003e DVA-C02) | Roman Kurnovskii","datePublished":"2022-07-06T00:00:00+00:00","dateModified":"2022-10-23T06:21:55+03:00","wordCount":2533,"publisher":{"@type":"Person","name":"Roman Kurnovskii","logo":{"@type":"ImageObject","url":"https://romankurnovskii.com/images/icon.png"}},"description":"Will create a distributed, scalable log aggregation system within AWS running on Amazon OpenSearch Service. This Log Aggregation System will ingest as much of your CloudWatch log stream events as you want, events generated from AWS EC2 Instances, Lambda functions, Databases, and anything else you want to submit log events from."}</script><link rel=preconnect href=https://www.google-analytics.com crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-26F2C5ZR4Y"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-26F2C5ZR4Y")</script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js?v2","ym"),ym(87734724,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/87734724 style=position:absolute;left:-9999px alt></div></noscript><script>let storageColorScheme=localStorage.getItem("lightDarkMode");const isDark2=JSON.parse(localStorage.getItem("DarkMode")||"false");isDark2?storageColorScheme="Dark":storageColorScheme="Light",((storageColorScheme=="Auto"||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches||storageColorScheme=="Dark")&&document.getElementsByTagName("html")[0].classList.add("dark")</script></head><body class="flex min-h-screen flex-col"><header><div class="mx-auto w-full max-w-screen-xl"><nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0"><button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="open mobile menu">
<i class="fas fa-bars"></i></button>
<a href=/en class="me-6 text-primary-text text-xl font-bold">Roman Kurnovskii</a><div id=mobile-burger-menu class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20"><ul id=menu><li class=parent><a href=/en/posts/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Notes</a><ul class=child><li class=parent><a href=/en/categories/aws/>AWS <span class=expand>»</span></a><ul class=child><li class=parent><a href=/en/docs/aws-certified-developer-associate/>AWS Developer Associate</a></li></ul></li><li class=parent><a href=/en/categories/os/>OS <span class=expand>»</span></a><ul class=child><li class=parent><a href=/en/categories/docker/>Docker</a></li><li class=parent><a href=/en/categories/linux/>Linux</a></li><li class=parent><a href=/en/categories/macos/>Mac</a></li></ul></li><li class=parent><a href=/en/categories/programming/>Programming <span class=expand>»</span></a><ul class=child><li class=parent><a href=/en/categories/hugo/>Hugo</a></li><li class=parent><a href=/en/categories/javascript/>JavaScript</a></li><li class=parent><a href=/en/categories/python/>Python</a></li></ul></li><li><a href=/en/categories/cheatsheet/>Cheat Sheet</a></li><li><a href=/en/p/links/>Links</a></li></ul></li><li class=parent><a href=/en/categories/roadmaps/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Roadmaps</a><ul class=child><li><a href=/en/docs/algorithms-101/>Algorithms101</a></li><li><a href=/en/docs/aws-certified-developer-associate/>AWS Developer Associate</a></li><li><a href=/ru/docs/disser/>Диссертация [RU]</a></li></ul></li><li class=parent><a href=/en/apps/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Apps</a></li></ul></div><div class=flex><div class="relative pt-4 md:pt-0"><form id=search class="flex items-center"><label for=search-input class=sr-only>Search</label><div class="relative w-full"><input type=text type=search id=search-input class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder=Search required></div></form></div><div class="relative pt-4 ps-2 md:pt-0"><button class="p-1 rounded border dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-700" onclick='location.href="/en/search/"'>
<img width=13 src=https://img.icons8.com/ios-glyphs/30/null/search-more.png></button></div></div></nav></div><div id=is-open-mobile class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0"></div><script>document.addEventListener("DOMContentLoaded",()=>{switchMobileMenuBurger()})</script></header><main class="grow pt-16"><div class=pl-scrollbar><div class="mx-auto w-full max-w-screen-2xl lg:px-2 xl:px-4"><div class=lg:pt-8><div class="flex flex-col md:flex-row bg-secondary-bg rounded"><div class="md:w-1/4 lg:w-1/5 border-e"><div class="sticky mt-12"><div id=sidebar-title class="md:hidden mx-4 px-2 pt-4 pb-2 md:border-b text-tertiary-text md:text-primary-text"><span class=font-semibold>Table of Contents</span>
<i class='fas fa-caret-right ms-1'></i></div><div id=sidebar-toc class="hidden md:block mx-6 md:mx-0 pe-2 pt-2 md:max-h-doc-sidebar bg-primary-bg md:bg-transparent"><div class="flex flex-wrap ms-1 -me-2 p-1 bg-secondary-bg md:bg-primary-bg rounded"><a class=hover:text-yalla href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/>AWS Certified Developer (DVA-C01 -> DVA-C02)</a></div><aside aria-label=Sidebar><div class="py-2 px-1"><ul id=doc__nav__sidebar class=space-y-1><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/iam/><span>IAM</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/ec2/><span>EC2</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticbeanstalk/><span>Elastic Beanstalk</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/lambda/><span>Lambda</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/>S3</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/create-s3-bucket/><span>Create S3 Bucket</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/create-folder-s3/><span>Create a folder inside S3 Bucket</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/upload-file-to-s3/><span>Upload a file to S3</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/grant-access-s3/><span>Grant public access to S3 Object</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/how-to-change-metadata-s3/><span>Change metadata of S3 Object</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/s3/delete-from-s3/><span>Delete S3 Bucket</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/dynamodb/>DynamoDB</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/dynamodb/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/dynamodb/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/dynamodb/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/dynamodb/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/dynamodb/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/dynamodb/introduction-dynamodb/><span>Introduction to DynamoDB</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticache/><span>ElastiCache</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/rds/><span>RDS</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/api-gateway/><span>API Gateway</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudfront/>CloudFront</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudfront/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudfront/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudfront/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudfront/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudfront/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudfront/configuring-static-website-s3-and-cloudfront/><span>Configuring a Static Website With S3 And CloudFront</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticloadbalancing/>Elastic Load Balancing</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticloadbalancing/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticloadbalancing/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticloadbalancing/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticloadbalancing/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticloadbalancing/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/elasticloadbalancing/create-amazon-load-balancing/><span>Create Classic Load Balancer</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kinesis/>Kinesis</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kinesis/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kinesis/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kinesis/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kinesis/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kinesis/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kinesis/sessionizing-clickstream-data-kinesis-data-analytics/><span>Sessionizing Clickstream Data with Amazon Kinesis Data Analytics</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/>OpenSearch Service</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/ class=ml-3><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/build-log-aggregation-system/ class=bg-tertiary-bg><span>Build A Log Aggregation System in AWS</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudwatch/>CloudWatch</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudwatch/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudwatch/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudwatch/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudwatch/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudwatch/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudwatch/introduction-to-cloudwatch/><span>Introduction to CloudWatch</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudformation/>CloudFormation</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudformation/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudformation/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudformation/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudformation/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudformation/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cloudformation/initializing-ec2-with-cloudformation/><span>Initializing Amazon EC2 Instances with AWS CloudFormation Init</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codecommit/>CodeCommit</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codecommit/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codecommit/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codecommit/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codecommit/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codecommit/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codecommit/introduction-codecommit/><span>Introduction to CodeCommit</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codedeploy/><span>CodeDeploy</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codebuild/><span>CodeBuild</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codepipeline/><span>CodePipeline</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codeguru/>CodeGuru</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codeguru/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codeguru/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codeguru/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codeguru/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codeguru/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codeguru/automating-code-reviews-amazon-codeguru/><span>Automating Code Reviews with Amazon CodeGuru</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codestar/>CodeStar</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codestar/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codestar/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codestar/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codestar/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codestar/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codestar/develop-and-deploy-app-with-codestar/><span>Develop and Deploy an Application with AWS CodeStar</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/codeartifact/><span>CodeArtifact</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/xray/><span>X-Ray</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/fis/><span>Fault Injection Simulator</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/ecr/><span>Elastic Container Registry</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/ecs/><span>Elastic Container Service</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/fargate/><span>Fargate</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/eks/><span>Elastic Kubernetes Service</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/cognito/><span>Cognito</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/route53/><span>Route 53</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kms/>Key Management Service</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kms/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kms/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kms/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kms/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kms/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/kms/encrypting-s3-objects-using-sse-kms/><span>Encrypting S3 Objects Using SSE-KMS</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/eventbridge/><span>EventBridge</span></a></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sns/>Simple Notification Service</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sns/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sns/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sns/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sns/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sns/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sns/aws-lambda-sns-notifications/><span>Process Amazon SNS Notifications with AWS Lambda</span></a></li></ul></li><li><div class=doc__nav__section><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sqs/>Simple Queue Service</a>
<button type=button aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sqs/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sqs/ aria-expanded=false>
<i class="fa-solid fa-angle-down fa-xs" aria-controls=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sqs/ data-collapse-toggle=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sqs/></i></button></div><ul id=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sqs/ class="ml-3 hidden"><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/sqs/fan-out-orders-with-sns-sqs/><span>Fan-Out Orders using Amazon SNS and SQS</span></a></li></ul></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/step-functions/><span>Step Functions</span></a></li><li><a href=https://romankurnovskii.com/en/docs/aws-certified-developer-associate/questions/><span>Questions</span></a></li></ul></div></aside></div></div></div><div class="w-full md:w-3/4 lg:w-4/5 pb-2 pt-2 md:pt-2"><div class=flex><div class="w-full lg:w-3/4 px-6"><article class=prose><h1>Build A Log Aggregation System in AWS</h1><div class="text-tertiary-text text-sm not-prose mt-2 flex flex-row flex-wrap items-center"><div class=me-4><i class="fa-regular fa-calendar-days"></i>
<span>Updated: 2022-10-23</span></div><div class=me-4><i class="fa-regular fa-clock"></i>
<span>12 min read</span></div><div id=page__views__div class="me-4 my-2"><i class="fa-regular fa-eye me-1"></i>
<span id=page__views></span></div></div><div class="block lg:hidden"><h3 class=text-lg>On This Page</h3><div class=break-words><nav id=TableOfContents><ul><li><a href=#lab>Lab</a></li><li><a href=#navigating-to-your-clouds-lambda-function>Navigating to Your Cloud&rsquo;s Lambda Function</a></li><li><a href=#creating-some-logs-using-aws-lambda>Creating Some Logs Using AWS Lambda</a></li><li><a href=#manually-viewing-logs-in-amazon-cloudwatch>Manually Viewing Logs in Amazon CloudWatch</a></li><li><a href=#launching-the-opensearch-domain>Launching the OpenSearch Domain</a></li><li><a href=#sending-cloudwatch-logs-to-opensearch>Sending CloudWatch Logs to OpenSearch</a></li><li><a href=#discovering-and-searching-events>Discovering and Searching Events</a></li><li><a href=#visualizing-aggregated-events>Visualizing Aggregated Events</a></li><li><a href=#creating-a-kibana-dashboard>Creating a Kibana Dashboard</a></li></ul></nav></div></div><h2 id=lab>Lab</h2><ul><li><a href=https://cloudacademy.com/lab/aws-devops-pro-monitoring-build-log-aggregation-system/>Monitor Like a DevOps Pro: Build A Log Aggregation System in AWS</a></li></ul><h2 id=navigating-to-your-clouds-lambda-function>Navigating to Your Cloud&rsquo;s Lambda Function</h2><p><a href=https://cloudacademy.com/admin/andrew-templeton/cloudacademy/blob/master/labs/devops/monitoring/001-nav-lambda/003-stack-current.png><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/lab-step/monitoring_-_001-nav-lambda_-_003-stack-current-dd8e6644-3b84-4c10-9b25-d2e947c5570a.png id=zoom-default alt="Stack Present State" title="Stack Present State" loading=lazy></p></a></p><p>1. In the AWS Management Console search bar, enter <em>Cloud Formation</em>, and click the <strong>CloudFormation</strong> result under <strong>Services</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429103956-1-1ab05279-24a2-4fc1-a6b0-d4f5f6d4bfca.png id=zoom-default alt=alt loading=lazy></p></p><p>This will bring you to the CloudFormation <strong>Stacks</strong> table.</p><p>There will be one stack named <strong>cloudacademylabs</strong> in the table with a <strong>Status</strong> of <strong>CREATE_COMPLETE</strong>.</p><p><em>Note</em>: If the stack hasn&rsquo;t reached the **Status **of <strong>CREATE_COMPLETE</strong>, try refreshing the page after a minute. It only takes a minute for the stack to fully create.</p><p>2. To view details of the stack, under <strong>Stack name</strong>, click the <strong>cloudacademylabs</strong> link.</p><p>3. Click the <strong>Resources</strong> tab:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid1-e3072d43-a3ce-44d8-b959-ab54e6cec193.png id=zoom-default alt=alt loading=lazy></p></p><p>Your <strong>Physical ID</strong>s will be different than in the supplied image. Note in the **Type **column that a <strong>DynamoDB Table</strong>, a <strong>Lambda Function</strong>, and **IAM **resources to grant the Lambda access to the DynamoDB Table have all been created. You will be querying the DynamoDB table via Lambda function invocations to create CloudWatch Logs, that will be aggregated and searchable via a user interface (UI).</p><p>4. Click on the <strong>Outputs</strong> tab, and open the <strong>DynamoLambdaConsoleLink</strong> link in the <strong>Value</strong> column:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid2-92ead771-0227-4fc1-8a90-6fc0b70e98cf.png id=zoom-default alt=alt loading=lazy></p></p><p>This takes you to the Lambda function Console.</p><h2 id=creating-some-logs-using-aws-lambda>Creating Some Logs Using AWS Lambda</h2><p>1. Briefly look around the Lambda function console:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-c86e2f84-2399-41c7-91a5-2ce969fc4e6d.png id=zoom-default alt=alt loading=lazy></p></p><p>The **Designer **gives a visual representation of the AWS resources that trigger the function (there are none in this case), and the AWS resources the function has access to (<strong>CloudWatch Logs</strong>, and <strong>DynamoDB</strong>). The actual code that is executed by the function is farther down in the <strong>Function</strong> **code **section. You don&rsquo;t need to worry about the actual implementation details of the function for this Lab.</p><p>2. To configure a test event to trigger the function, scroll down to the <strong>Code source</strong> section and click <strong>Test</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429104333-3-c6a814b6-dc70-415f-b0cb-9b1215d217b8.png id=zoom-default alt=alt loading=lazy></p></p><p>3. In the <strong>Configure test event</strong> form, enter the following values before scrolling to the bottom and click <strong>Save</strong>:</p><ul><li><strong>Event name</strong>:<em>TestPutEvent</em></li><li>Enter the following in the code editor at the bottom of the form:</li></ul><p><a href=https://cloudacademy.com/lab/aws-devops-pro-monitoring-build-log-aggregation-system/creating-some-logs/#>Copy code</a></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a></span><span>{
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-2>2</a></span><span>  &#34;fn&#34;: &#34;PUT&#34;,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-3>3</a></span><span>  &#34;data&#34;: {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-4>4</a></span><span>    &#34;id&#34;: &#34;12345&#34;,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-5>5</a></span><span>    &#34;name&#34;: &#34;foobar&#34;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-6>6</a></span><span>  }
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-7>7</a></span><span>}
</span></span></code></pre></div><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429104153-2-74fea1fd-a7ef-41eb-a9dd-5c957f851955.png id=zoom-default alt=alt loading=lazy></p></p><p>The <code>PUT</code> object event will update the DynamoDB database with an object with the given <code>id</code>.</p><p>4. To run your function with your test event, click <strong>Test</strong> again:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429104333-3-c6a814b6-dc70-415f-b0cb-9b1215d217b8.png id=zoom-default alt=alt loading=lazy></p></p><p>After a few seconds, in the code editor, a tab called <strong>Execution results</strong> will load:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid0-aa86da8f-1584-4752-a40c-ef07b72aeac5.png id=zoom-default alt=alt loading=lazy></p></p><p>The function succeeded and the <strong>Function Logs</strong>area displays the logs that were generated and automatically sent to CloudWatch Logs by AWS Lambda.</p><p>5. To view the Amazon CloudWatch logs, click the <strong>Monitor</strong> tab, and then click <strong>View logs in CloudWatch</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-7b37e04d-72fb-46da-b099-c729ba64edfc.png id=zoom-default alt=alt loading=lazy></p></p><p><em>Note</em>: The Lab&rsquo;s CloudFormation stack outputs also include a link to the Log Group if you need to access it at a later time.</p><h2 id=manually-viewing-logs-in-amazon-cloudwatch>Manually Viewing Logs in Amazon CloudWatch</h2><p>1. Observe the <strong>Log Streams</strong> in the CloudWatch log group for the Lambda function you invoked:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid0-2ab20151-639d-451a-8795-96c697c7d4e6.png id=zoom-default alt=alt loading=lazy></p></p><p>The rows in the table are different <strong>Log Streams</strong> for the log group.</p><p>Each log stream corresponds to log events from the same source. AWS Lambda creates a new log event for every Lambda invocation. However, it is possible to have multiple log streams for a single Lambda function since the log stream corresponds to the container actually running the function.</p><p>Behind the scenes, a Lambda is run in a container. After a period of inactivity, the container is unloaded and the following requests will be served by a new container, thus creating a new log stream. Depending on how many times you invoked the test command in the previous step, you will see one or more rows in the log stream.</p><p>2. Click on the latest <strong>Log Stream</strong>.</p><p>The log stream is a record of event <strong>Message</strong>s ordered in <strong>Time</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid1-d697e02d-a3fd-4199-aa83-b2cd851be239.png id=zoom-default alt=alt loading=lazy></p></p><p>3. Enter _PUT _into the **Filter events **search bar and click enter:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-2c35a0b3-8eaf-4570-944d-8c48bde7f8f7.png id=zoom-default alt=alt loading=lazy></p></p><p>4. Click the triangle to expand the event that matches the filter.</p><p>You will see the JSON formatted message:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-5155cec1-7cbf-4b5c-8449-16cde6e95b5a.png id=zoom-default alt=alt loading=lazy></p></p><p>The outermost <strong>data</strong> attribute wraps the test event you configured.</p><p>5. Click <strong>custom</strong> to display the custom time range filter available in CloudWatch Logs:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-d127b138-c6dd-42a4-81ea-1d750cd098db.png id=zoom-default alt=alt loading=lazy></p></p><p>Observe the time-based options in the dialog box that displays:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-17c88ed8-e129-4792-96bf-3f534648ff5d.png id=zoom-default alt=alt loading=lazy></p></p><p>The filter by text and by time capabilities are the tools that are available for sifting through logs in CloudWatch Logs. The <a href=https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/FilterAndPatternSyntax.html>text filters support some forms of conditions</a> that can be expressed through a syntax specific to CloudWatch. These capabilities are handy, but you will see that there are more powerful tools available for log aggregation and retrieval.</p><h2 id=launching-the-opensearch-domain>Launching the OpenSearch Domain</h2><p>The first thing you need is an Amazon OpenSearch cluster/domain. Using the Amazon OpenSearch Service has the following benefits:</p><ul><li>It&rsquo;s distributed and resilient</li><li>It supports aggregations</li><li>It supports free-text search</li><li>It&rsquo;s managed and takes care of most of the operational complexities of operating a cluster</li></ul><p>In 2021 AWS renamed Amazon ElasticSearch Service to Amazon OpenSearch Service. You may see references to ElasticSearch in the Amazon Management Console. You should assume that ElasticSearch and OpenSearch refer to the same AWS service.</p><p>The following diagram illustrates the overall design of the AWS Lab environment and the part that you are building in this lab step is highlighted in the lower-left corner in the AWS cloud:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid0-7741a6ee-ea07-406a-9143-369a80ef0f12.png id=zoom-default alt=alt loading=lazy></p></p><p>1. In the search bar at the top, enter <em>OpenSearch</em>, and under <strong>Services</strong>, click the <strong>Amazon OpenSearch Service</strong> result:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429104628-4-cead0ef4-208e-4965-ab2f-3b81a9e8446e.png id=zoom-default alt=alt loading=lazy></p></p><p>2. To begin creating your cluster, on the right-hand side of the welcome page, click <strong>Create domain</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429104712-5-554c5f72-1ca0-4486-841a-362ae8e87ec4.png id=zoom-default alt=alt loading=lazy></p></p><p>The terms OpenSearch domain and an OpenSearch cluster can be used almost interchangeably. The former is the logical search resource, and the latter is the actual servers that are launched to create a domain.</p><p>The <strong>Create domain</strong> form will load. </p><p>3. In the <strong>Name</strong> section, in the <strong>Domain name</strong> textbox, enter <em>ca-labs-domain-###</em>, replacing ### with some random numbers:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-f2ef669c-a638-47ff-970c-3bb3df428b2d.png id=zoom-default alt=alt loading=lazy></p></p><p>4. In the <strong>Deployment type</strong> section, select the following:</p><ul><li><strong>Deployment type</strong>: Select <strong>Development and testing</strong></li><li><strong>Version</strong>: Select **6.8 **under <strong>ElasticSearch</strong></li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-36a2a586-ddee-460a-ae08-e036fdd6a169.png id=zoom-default alt=alt loading=lazy></p></p><p>In this short-lived lab, you are using a Development and testing deployment because it allows public access and reliability isn&rsquo;t a concern. In a production environment, you will want to use a Production deployment to get the full availability benefits and meet security requirements.</p><p>5. In the Auto-Tune section, select <strong>Disable</strong>.</p><p>In this short-lived lab, Auto-Tune is not necessary.</p><p>6. In the <strong>Data nodes</strong> section, enter and select the following and leave remaining defaults:</p><ul><li><strong>Instance type</strong>: Select <strong>t3.small.search</strong></li><li><strong>Number of nodes</strong>: Enter <em>1</em></li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220510112534-1-bb3915db-05d2-4fbd-82b5-0e933ad5281a.png id=zoom-default alt=alt loading=lazy></p></p><p>The storage type values correspond to the storage types available for Amazon EC2 instances.</p><p>When deploying a cluster that uses multiple nodes, you can specify that the nodes are deployed in two or three availability zones. Deploying in multiple availability zones makes the cluster highly available and more reliable in the case of failures of outages.</p><p>7. Scroll down to the <strong>Network</strong> section, and select <strong>Public access</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-98784143-ac05-420f-b6b3-2e5213787b19.png id=zoom-default alt=alt loading=lazy></p></p><p>In this lab, you are creating a publicly available Amazon OpenSearch Service cluster for convenience. Be aware that you can also deploy a cluster into an Amazon Virtual Private Cloud (VPC) and receive the network isolation and security advantages of using a VPC.</p><p>8.  In the **Fine-grained access control **section, uncheck the **Enable fine-grained access control **box.</p><p>9. In a new browser tab, enter the following URL:</p><p><a href=https://checkip.amazonaws.com/>https://checkip.amazonaws.com/</a></p><p>You will see an IP address displayed. This is the public IPv4 address of your internet connection. You will use this IP address to restrict access to your Amazon OpenSearch Service cluster.</p><p>10. Scroll down to the <strong>Access Policy</strong> section and under <strong>Domain access policy</strong>, select <strong>Configure domain level access policy</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429105143-7-146d73ea-3a3a-4bfd-bfb1-4293e282590c.png id=zoom-default alt=alt loading=lazy></p></p><p>You will see a policy editor form display with the tabs <strong>Visual editor</strong> and <strong>JSON</strong>.</p><p>11. In the <strong>Visual editor</strong> tab, enter and select the following:</p><ul><li><strong>Type</strong>: Select <strong>IPv4</strong> <strong>address</strong></li><li><strong>Principal</strong>: Enter the IP address you saw on the <a href=https://checkip.amazonaws.com/>Check IP Page</a></li><li><strong>Action</strong>: Select <strong>Allow</strong></li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429105226-9-19d81744-2561-4cd5-887b-0256a54745b4.png id=zoom-default alt=alt loading=lazy></p></p><p>You are specifying an access policy that allows access to the cluster from your IP address. In a non-lab environment, you could deploy the cluster into an Amazon VPC and configure private or public access using a VPC&rsquo;s networking features.</p><p>12. To finish creating your cluster, scroll to the bottom and click <strong>Create</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429105337-10-0e7e8951-2052-4df0-889d-cebfc68e2c7a.png id=zoom-default alt=alt loading=lazy></p></p><p>A page displaying details of your cluster will load and you will see a green notification that you have successfully created a cluster.</p><p>13. In the <strong>General information</strong> section, observe the <strong>Domain status</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-f1a5ea63-82b6-421c-b140-3f3f9f05262f.png id=zoom-default alt=alt loading=lazy></p></p><p>AWS is setting up and deploying your cluster. This process can take up to 15 or 30 minutes to complete.</p><p>12. To see the latest status of your Amazon OpenSearch Service cluster, refresh the page in your browser.</p><p>Refresh the page for your domain periodically to check if it has finished deploying.</p><p>Whilst waiting for the domain to finish provisioning, feel free to consult the <a href=https://docs.aws.amazon.com/opensearch-service/latest/developerguide/what-is.html>Amazon OpenSearch Service Developer Guide</a> to learn more about the OpenSearch service.</p><p>When the cluster has been provisioned you will see the <strong>Domain status</strong> change to <strong>Active</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-a35c2d2b-f3b5-4318-8d25-4dc30d380f9f.png id=zoom-default alt=alt loading=lazy></p></p><h2 id=sending-cloudwatch-logs-to-opensearch>Sending CloudWatch Logs to OpenSearch</h2><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid0-009932ef-f50b-4999-9611-3f9696e27c04.png id=zoom-default alt=alt loading=lazy></p></p><p>1. In the AWS Management Console search bar, enter <em>CloudWatch</em>, and click the <strong>CloudWatch</strong> result under <strong>Services</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429105851-11-466c7875-126b-4ba8-a89a-76bd3391147b.png id=zoom-default alt=alt loading=lazy></p></p><p>2. In the left-hand menu, under <strong>Logs</strong>, click on <strong>Log groups</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-fc711aeb-a1a7-42ea-8ad1-84b0b95a2f81.png id=zoom-default alt=alt loading=lazy></p></p><p>3. Select the log group beginning with <strong>/aws/lambda/cloudacademylabs-DynamoLambda-</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-e4c08c67-c1da-4d2c-9c87-b51fc4e00d22.png id=zoom-default alt=alt loading=lazy></p></p><p>Next, you will create a subscription filter to send the log data to your ElasticSearch domain.</p><p>4. Click <strong>Actions</strong>, in the menu that opens, under <strong>Subscription filters</strong>, click <strong>Create Amazon OpenSearch Service subscription filter</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220117132239-1-fba0f7bf-82d2-4320-be34-ec05848ba00d.png id=zoom-default alt=alt loading=lazy></p></p><p>The <strong>Create Amazon OpenSearch Service subscription filter</strong> form will load.</p><p>5. In the <strong>Choose destination</strong> section, select the following:</p><ul><li><strong>Select account</strong>: Ensure **This account **is selected</li><li><strong>Amazon OpenSearch Service cluster</strong>: Select the cluster you created previously</li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-7ef938b7-bd69-4dfc-99ce-6ea59f5fb60c.png id=zoom-default alt=alt loading=lazy></p></p><p>After selecting the <strong>Amazon OpenSearchService cluster</strong>, the <strong>Lambda function</strong> section will appear.</p><p>6. In the <strong>Lambda IAM Execution Role</strong> drop-down select <strong>LambdaElasticSearch</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-f4fb049e-4d99-496d-bc43-3e42f04402e0.png id=zoom-default alt=alt loading=lazy></p></p><p>7. In the <strong>Configure log format and filters</strong> section enter the following:</p><ul><li><strong>Log Format</strong>: Select <strong>Amazon Lambda</strong></li><li><strong>Subscription filter name</strong>: ca-lab-filter</li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-d5839242-3363-4f9e-afb5-a3fd6b2a05d7.png id=zoom-default alt=alt loading=lazy></p></p><p>The default <strong>Subscription Filter Pattern</strong> matches the <strong>timestamp</strong>, <strong>request_id</strong>, and <strong>event</strong> JSON. The **Test Pattern **button is available to see which events match the pattern.</p><p>8. To start sending the logs to ElasticSearch, at the bottom, click <strong>Start streaming</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-25f03599-a3d9-4ce4-9331-8476e4592c5e.png id=zoom-default alt=alt loading=lazy></p></p><p>Momentarily, you will see a notification that the subscription filter has been created and logs are being streamed to OpenSearch:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-d8941820-2c7a-4d6c-a6d0-5e85d46bc3c4.png id=zoom-default alt=alt loading=lazy></p></p><h2 id=discovering-and-searching-events>Discovering and Searching Events</h2><p>1. Navigate back to the Lambda function you invoked earlier and click the <strong>Test</strong> button a few times to submit more <code>PUT</code> events:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-a38f9d29-7315-43c1-b442-6b1d855392ad.png id=zoom-default alt=alt loading=lazy></p></p><p>2. Click the arrow on the <strong>Test</strong> button and click <strong>Configure test event</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-51bbc453-07d5-4168-9909-ede9f7c1473c.png id=zoom-default alt=alt loading=lazy></p></p><p>3. In the **Configure test events **form, click the radio button for <strong>Create new test event</strong> and enter the following non-default values:</p><ul><li><strong>Event name</strong>:<em>TestGetEvent</em></li><li>Enter the following in the code editor at the bottom of the form:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a></span><span>{
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a></span><span>&#34;fn&#34;: &#34;GET&#34;,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3>3</a></span><span>&#34;id&#34;: &#34;12345&#34;
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4>4</a></span><span>}
</span></span></code></pre></div><p>You will submit more test events of a different type - <code>GET</code> operations on the object that was PUT in the database. This gives two different event types to look at in Kibana (the Log Aggregation UI).</p><p>4. Click <strong>Save</strong>.</p><p>5. Click <strong>Test</strong> several times to make GET events.</p><p>6. Return to the <a href="https://us-west-2.console.aws.amazon.com/esv3/home?region=us-west-2#opensearch/domains">Amazon OpenSearch Search Console</a> for the domain you created and click the link under <strong>Kibana URL</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-78733904-1afa-4213-b04b-a8933443959b.png id=zoom-default alt=alt loading=lazy></p></p><p>7. In the <strong>Add Data to Kibana</strong> section, on the right-hand side under <strong>Use Elasticsearch data</strong>, click <strong>Connect to your Elasticsearch index</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429120402-12-fd000897-765b-47ea-8e9a-d87c8cd9ec48.png id=zoom-default alt=alt loading=lazy></p></p><p>The log data is stored in OpenSearch, but you need to tell Kibana which index to use for discovering the data.</p><p>8. In the **Create an index pattern **wizard, enter the following value and click <strong>Next step</strong>:</p><ul><li><strong>Index pattern</strong>: <em>cwl-*</em></li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-54b96c47-4ada-441d-88e6-25cda005d59b.png id=zoom-default alt=alt loading=lazy></p></p><p>The pattern will match the daily CloudWatch Logs (cwl) indices that are created in Amazon OpenSearch.</p><p>9. In the second step, enter the following value and click <strong>Create index pattern</strong>:</p><ul><li><strong>Index pattern</strong>: Select <strong>@timestamp</strong></li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-36a09028-2a11-4449-87a4-c96f0e745139.png id=zoom-default alt=alt loading=lazy></p></p><p>The <strong>Time filter field name</strong> allows Kibana to determine which attribute represents the timestamp of each event. The confirmation page displays all of the fields in the log data index:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-20220429120524-13-899ae362-6309-4b92-8812-6c05143926c4.png id=zoom-default alt=alt loading=lazy></p></p><p>Now that the index settings for Kibana are configured, you can begin using the Log Aggregation system!</p><p>10. Click <strong>Discover</strong> in the sidebar menu on the left of the page.</p><p>11. Explore the <strong>Discover</strong> interface:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-13d31721-22ca-429d-b1da-9db07022872b.png id=zoom-default alt=alt loading=lazy></p></p><p>You see some events and a graph. These are your aggregated log events! The system is online! Notice the search bar up top. It is initially empty so all log events will show up. But what if you only want to see the <code>PUT</code> events for objects containing <code>12345</code>?</p><p>12. Enter <em>PUT 12345</em> in the search bar and press <em>enter</em>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-b4faf1fb-037f-466f-ad24-00471e40c765.png id=zoom-default alt=alt loading=lazy></p></p><p>The matching terms in the event show up highlighted, and the bar graph updates to show only the count of <code>PUT 12345</code> events that you made by clicking Test in the Lambda interface.</p><p>13. Click on the timestamp range in the upper-right corner to display the time filter:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-d330af07-67e3-4f6c-b35d-039b64fcb4c7.png id=zoom-default alt=alt loading=lazy></p></p><p>Just as with CloudWatch Logs, you can filter the logs by time. However, in Kibana you can also drag on the bar chart to select a time range visually:<p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-ccedfb80-2f1e-4813-badd-d193678398f8.png id=zoom-default alt=alt loading=lazy></p></p><h2 id=visualizing-aggregated-events>Visualizing Aggregated Events</h2><p>1. Click <strong>Visualize</strong> in the Kibana sidebar menu.</p><p>2. Click <strong>Create a visualization</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-39ffb0a3-dac2-4ba4-b874-05b84ab5425e.png id=zoom-default alt loading=lazy></p> </p><p>3. Select **Area **chart visualization:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-f41590aa-4cbc-4ff6-a4cb-a31f06f4d31c.png id=zoom-default alt loading=lazy></p> </p><p>4. In the **From a New Search, Select Index **area, click on the *<em>cwl-</em> **index name:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-cde54f05-5181-492e-a22e-f27fe855ee0f.png id=zoom-default alt loading=lazy></p></p><p>If you had any saved searches in the system, you could use them to make this Visualization from this step.</p><p>On the left-hand side, the visualization configuration tools will appear:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-18b5fd4c-dd64-4fc1-b9e8-b038975c5b81.png id=zoom-default alt loading=lazy></p></p><p>5. Enter the following values in the visualization configuration:</p><ul><li><strong>Select buckets type</strong>: X-Axis</li><li><strong>Aggregation</strong>: Date Histogram (to track log trends over time)</li><li><strong>Field</strong>: @timestamp</li><li><strong>Interval</strong>: Auto</li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-48fd650d-57b9-4f2a-b830-1e27300abc97.png id=zoom-default alt loading=lazy></p></p><p>To make the graph more interesting, you will split the <code>PUT</code>s and <code>GET</code>s and display each stacked in on the chart with different colors. This requires a sub-buckets.</p><p>6. Click <strong>Add sub-buckets</strong> below the rest of the X-Axis settings, and enter the following values:</p><ul><li><strong>Select buckets type</strong>: Split Series</li><li><strong>Sub Aggregation</strong>: Terms (Terms splits the data based on the unique values of a field)</li><li><strong>Field</strong>: $event.data.fn.keyword (The test requests used the <code>fn</code> key for request type, which maps to the <code>$event.data.fn.keyword</code> field in OpenSearch)</li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-97f08c02-b39b-48ef-be55-6e67371c67e6.png id=zoom-default alt loading=lazy></p></p><p>7. Click the play button to apply the changes and produce the visualization:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-0ca6c0de-4f5c-4d05-940e-340942cef195.png id=zoom-default alt loading=lazy></p></p><p>It will look something like the image below, with two regions in an area graph corresponding to <code>GET</code> and <code>PUT</code> event count over time:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-7271c269-fdba-4b82-8639-4a212e5dd9b7.png id=zoom-default alt loading=lazy></p></p><p>To use the visualization in a Dashboard in the next step, you need to save the visualization.</p><p>8. Click <strong>Save</strong> in the top toolbar:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid8-cc197d51-015a-43cb-9630-fe84045ab1da.png id=zoom-default alt loading=lazy></p></p><p>9. Enter <em>PUTs and GETs Over Time</em> in the <strong>Save Visualization</strong> field, and click <strong>Save</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid0-5102a936-c27f-4faa-a82d-36e715158769.png id=zoom-default alt loading=lazy></p></p><h2 id=creating-a-kibana-dashboard>Creating a Kibana Dashboard</h2><p>1. Click on <strong>Dashboard</strong> in the sidebar menu.</p><p>2. Click <strong>Create a dashboard</strong>:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-3b35b537-4970-48b4-be62-2c81b48c0051.png id=zoom-default alt loading=lazy></p></p><p>3. Click <strong>Add</strong> to add saved visualizations to the dashboard:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-ba7f2ef5-cdb0-42f6-bff0-42599f981064.png id=zoom-default alt loading=lazy></p></p><p>4. Select the <strong>PUT and GETs Over Time</strong> visualization:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-4b5a77dd-34ba-4160-83f6-b04155106302.png id=zoom-default alt loading=lazy></p></p><p>The visualization is added to the dashboard, but the size may not be what you like. You can adjust the size of the visualization by dragging the arrow in the lower-right corner:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid4-574f79c4-872a-47dc-8c0d-ac0869f3aa5b.png id=zoom-default alt loading=lazy></p></p><p>5. Click <strong>Save</strong> and enter the following values before clicking the revealed **Save **button:</p><ul><li><strong>Title</strong>: <em>Log Dashboard</em></li><li><strong>Description</strong>: <em>Lambda API Logs</em></li></ul><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid5-fb534834-2ccf-45ee-a4cc-bfc39ba3c85d.png id=zoom-default alt loading=lazy></p></p><p>You&rsquo;ve done it! The <strong>Dashboard</strong> will always contain the up-to-date statistics for your <code>GET</code> and <code>PUT</code> events that run through the Lambda function:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-76481012-22d4-4e7d-b685-99068379a418.png id=zoom-default alt loading=lazy></p></p><p>6. Return to the Lambda console and create as many test events as you want.</p><p>7. Refresh the Kibana dashboard and see the new requests in the visualization:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/content_engine/image-fd3120c6-1172-4316-82f5-467a8c262d26.png id=zoom-default alt loading=lazy></p> </p><p>You can also configure <strong>Auto-refresh</strong> to avoid having to refresh the view:</p><p><p class=md__image><img src=https://assets.cloudacademy.com/bakery/media/uploads/blobid9-fb565076-2734-4692-976b-94387d87bb68.png id=zoom-default alt loading=lazy></p></p></article><div id=open_comments_block></div><script src=/opencomments.js renderdivid=open_comments_block server=https://eyt4njm3se.execute-api.eu-west-1.amazonaws.com/comments awstag defer></script></div><div class="hidden lg:block lg:w-1/4"><div class="bg-primary-bg prose sticky top-7 z-10 hidden
px-6 lg:block"><h3 class=text-lg>On This Page</h3></div><div class="sticky-toc hidden px-0 pb-6 lg:block"><nav id=TableOfContents><ul><li><a href=#lab>Lab</a></li><li><a href=#navigating-to-your-clouds-lambda-function>Navigating to Your Cloud&rsquo;s Lambda Function</a></li><li><a href=#creating-some-logs-using-aws-lambda>Creating Some Logs Using AWS Lambda</a></li><li><a href=#manually-viewing-logs-in-amazon-cloudwatch>Manually Viewing Logs in Amazon CloudWatch</a></li><li><a href=#launching-the-opensearch-domain>Launching the OpenSearch Domain</a></li><li><a href=#sending-cloudwatch-logs-to-opensearch>Sending CloudWatch Logs to OpenSearch</a></li><li><a href=#discovering-and-searching-events>Discovering and Searching Events</a></li><li><a href=#visualizing-aggregated-events>Visualizing Aggregated Events</a></li><li><a href=#creating-a-kibana-dashboard>Creating a Kibana Dashboard</a></li></ul></nav><div class="feedback-links mt-4 text-sm"><hr><div><a href=https://github.com/romankurnovskii/romankurnovskii.github.io/edit/main/content/docs/aws-certified-developer-associate/opensearch-service/build-log-aggregation-system/index.en.md title="Edit this page" target=_blank><i class="fas fa-edit me-1"></i>
<span>Edit this page</span></a></div><div><a href="https://github.com/romankurnovskii/romankurnovskii.github.io/issues/new/?body=File:%20[/content/docs/aws-certified-developer-associate/opensearch-service/build-log-aggregation-system/index.en.md/]%28/https:/romankurnovskii.com/en/docs/aws-certified-developer-associate/opensearch-service/build-log-aggregation-system/%29" title="Request issue" target=_blank><i class="fas fa-check me-1" aria-hidden=true></i>
<span>Request page change</span></a></div></div></div><script>window.addEventListener("DOMContentLoaded",()=>{enableStickyToc()})</script></div></div></div></div></div><script>document.addEventListener("DOMContentLoaded",()=>{changeSidebarHeight(),switchDocToc()})</script></div></div></main><footer class=pl-scrollbar><div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b"><p class="text-sm text-tertiary-text">&copy; 2023 <a href=https://romankurnovskii.com>Roman Kurnovskii</a> personal page
&#183;
<a href=https://romankurnovskii.com/en/index.xml target=_blank>RSS</a>
&#183;
<a href=https://gohugo.io>Hugo</a> 9db743b 2022-10-23</p></p></div><script src=/js/lunr.stemmer.support.min.js></script>
<script src=/js/lunr.ru.min.js></script>
<script src=/js/lunr.multi.min.js></script>
<script src=/js/search.js?v1 languagemode=en></script><div id=search-result tabindex=-1 class="overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 max-w-xs" hidden><div class="relative p-4 w-full max-w-xs h-full md:h-auto"><div class="relative bg-white rounded-lg shadow dark:bg-gray-700"><div class=p-6><h3>Search results</h3><div id=popup_search_results class=prose></div></div></div></div></div><script src=/js/search-page.js?v3></script>
<script src=/js/base.js?5 languagemode=en></script></div></footer><script src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js defer></script>
<script src=/js/zoom-image/placeholders.js?4 defer></script>
<script src=/js/zoom-image/index.js?4 defer></script></body></html>