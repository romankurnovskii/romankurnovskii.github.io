{{ $currentPage := .permalink | absLangURL }}

{{ range .context.Pages.ByWeight }}

{{ $relPermalink := .RelPermalink | absLangURL }}
{{ $eqq := eq $relPermalink $currentPage }}
{{ $ischild := hasPrefix $currentPage $relPermalink }}

{{ if .IsSection }}

<li>
  <div class="doc__nav__section">
    <a href="{{ .Permalink }}" class="{{ if $eqq }} bg-tertiary-bg {{ end }}">
      <span>{{ .LinkTitle }}</span>
    </a>

    <button type="button" aria-controls="{{ .Permalink }}" data-collapse-toggle="{{ .Permalink }}" aria-expanded="true">
      <i class="fa-solid fa-angle-down" aria-controls="{{ .Permalink }}" data-collapse-toggle="{{ .Permalink }}"
        aria-expanded="true"></i>
    </button>
  </div>

  <ul id="{{ .Permalink }}" class="ml-3 {{ if not $ischild  }} hidden {{ end }}">
    {{ partial "components/docs/menu-link" (dict "context" . "permalink" $.permalink) }}
  </ul>
</li>

{{ else }}

<li>
  <a href="{{ .Permalink }}" class="{{ if $eqq }} bg-tertiary-bg {{ end }}">
    <span>{{ .LinkTitle }}</span>
  </a>
</li>

{{ end }}

{{ end }}