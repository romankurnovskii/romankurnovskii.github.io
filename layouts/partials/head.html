<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

{{ define "partials/get-title" }}
  {{ $separator := .Site.Params.titleSeparator | default "|" }}
  {{ $primarySep := $separator }}
  {{ $secondarySep := $separator }}
  {{ if reflect.IsSlice $separator }}
    {{ $primarySep = index $separator 0 }}
    {{ $secondarySep = index $separator 1 | default (index $separator 0) }}
  {{ end }}
  {{ $title := .Site.Title }}
  {{/* Generate prefix */}}
  {{ $prefix := "" }}
  {{ if .Params.Title }}
    {{ $prefix = .Params.Title }}
    {{/* Deprecation warning(v1.0.0) starts */}}
    {{ $layout := partial "utils/hyphenate" (.Layout | default .Type) }}
    {{/* Deprecation warning(v1.0.0) ends */}}
    {{ if and (eq .Type "docs") (ne $layout "doc-list") }}
      {{ $docTitle := "" }}
      {{ $bundles := partial "utils/get-bundles" . }}
      {{ range $bundles.Reverse }}
        {{ $version := findRE
          "v?(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?"
          (path.Base .Permalink)
        }}
        {{/* Deprecation warning(v1.0.0) starts */}}
        {{ $parentLayout := partial "utils/hyphenate" (.Parent.Layout | default .Parent.Type) }}
        {{ $layout := partial "utils/hyphenate" (.Layout | default .Type) }}
        {{/* Deprecation warning(v1.0.0) ends */}}
        {{ if and (eq $parentLayout "doc-list") (ne $layout "doc-list") }}
          {{ $docTitle = .Title }}
        {{ else if $version }}
          {{ $docTitle = .Title }}
        {{ end }}
      {{ end }}
      {{/* Doc title */}}
      {{ $version := findRE
        "v?(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?"
        (path.Base .Permalink)
      }}
      {{/* Deprecation warning(v1.0.0) starts */}}
      {{ $parentLayout := partial "utils/hyphenate" (.Parent.Layout | default .Parent.Type) }}
      {{/* Deprecation warning(v1.0.0) ends */}}
      {{ if or (eq $parentLayout "doc-list") $version }}
        {{ $prefix = $docTitle }}
      {{ else }}
        {{ $prefix = print $prefix " " $secondarySep " " $docTitle }}
      {{ end }}
    {{ end }}
  {{ end }}
  {{/* Add prefix */}}
  {{ with $prefix }}
    {{ $title = print . " " $primarySep " " $title }}
  {{ end }}
  {{ return $title }}
{{ end }}
<title>{{ partial "get-title" . }}</title>

<meta name="generator" content="Hugo Eureka {{ .Site.Data.eureka.version }}" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js" integrity="sha512-8pHNiqTlsrRjVD4A/3va++W1sMbUHwWxxRPWNyVlql3T+Hgfd81Qc6FC5WMXDC+tSauxxzp1tgiAvSKFu1qIlA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

{{/* for image gallery / put above, because needed styles will overwrite | TODO fix it, take needed styles */}}
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
  crossorigin="anonymous"
/>

{{- $eurekaCSS := resources.Get "css/eureka.css" | postCSS (dict "config" "./assets/css/postcss.config.js"
  "inlineImports" true) | resources.ExecuteAsTemplate "css/eureka.css" . | minify | fingerprint "sha384"
}}
<link rel="stylesheet" href="{{ $eurekaCSS.Permalink }}" />

{{- $eurekaJS := resources.Get "js/eureka.js" | resources.ExecuteAsTemplate "js/eureka.js" . | minify | fingerprint
  "sha384"
}}
<script defer src="{{ $eurekaJS.Permalink }}"></script>

{{/* React, axios */}}
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script
  src="https://unpkg.com/react@16/umd/react.production.min.js"
  crossorigin
></script>
<script
  src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"
  crossorigin
></script>
<script src="https://unpkg.com/lunr/lunr.min.js"></script>

{{ $googleFonts := "" }}
{{ range $index, $value := partial "utils/get-style-fonts" (dict "context" . "param" "googleFonts") }}
  {{ with $value }}
    {{ $googleFonts = print $googleFonts "family=" . "&" }}
  {{ end }}
{{ end }}

{{ with $googleFonts }}
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    rel="preload"
    href="{{ printf " https://fonts.googleapis.com/css2?%sdisplay=swap" . }}"
    as="style"
    onload="this.onload=null;this.rel='stylesheet'"
  />
{{ end }}


<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600&display=swap"
  rel="stylesheet"
/>

{{- $assets := .Site.Data.assets }}

{{/* highlight */}}
{{- if eq .Site.Params.highlight.handler "chroma" }}
  {{- $highlightCSS := resources.Get "css/syntax.css" | minify | fingerprint "sha384" }}
  <link
    rel="stylesheet"
    href="{{ $highlightCSS.Permalink }}"
    media="print"
    onload="this.media='all';this.onload=null"
  />
{{- else if eq .Site.Params.highlight.handler "highlightjs" }}
  {{- $highlightjsStyle := .Site.Params.highlight.highlightjs.style | default "base16/solarized-light" }}
  <link
    rel="stylesheet"
    href="{{ printf $assets.highlightjs.css.url $assets.highlightjs.version $highlightjsStyle }}"
    {{ with $assets.highlightjs.css.sri }}integrity="{{ . }}"{{ end }}
    media="print"
    onload="this.media='all';this.onload=null"
    crossorigin
  />
  <script
    defer
    src="{{ printf $assets.highlightjs.js.url $assets.highlightjs.version }}"
    {{ with
      $assets.highlightjs.js.sri
    }}
      integrity="{{ . }}"
    {{ end }}
    crossorigin
  ></script>
  {{- range .Site.Params.highlight.highlightjs.languages }}
    <script
      defer
      src="{{ printf $assets.highlightjs.languages.url $assets.highlightjs.version . }}"
      {{ with
        $assets.highlightjs.languages.sri
      }}
        integrity="{{ . }}"
      {{ end }}
      crossorigin
    ></script>
  {{- end }}
  {{- $highlightjsCSS := resources.Get "css/highlightjs.css" | minify | fingerprint "sha384" }}
  <link
    rel="stylesheet"
    href="{{ $highlightjsCSS.Permalink }}"
    media="print"
    onload="this.media='all';this.onload=null"
  />
{{- end }}

{{- $enableMath := false }}
{{- if .Site.Params.math.handler }}
  {{- $bundles := partial "utils/get-bundles" . }}
  {{- $enableMath = true }}
  {{- range $bundles.Reverse }}
    {{- if and (ne .Params.enableMath nil) (ne .Params.enableMath "") }}
      {{- $enableMath = .Params.enableMath }}
      {{/* Deprecation warning(v1.0.0) starts */}}
    {{- else if and (ne .Params.math nil) (ne .Params.math "") }}
      {{ warnf "Param 'math' in %q is deprecated and will be removed in Eureka v1.0.0. Please use 'enableMath' instead."
        .File.Path
      }}
      {{- $enableMath = .Params.math }}
      {{/* Deprecation warning(v1.0.0) ends */}}
    {{- end }}
  {{- end }}
{{- end }}

{{/* KaTeX */}}
{{- if and (eq .Site.Params.math.handler "katex") $enableMath }}
  <link
    rel="stylesheet"
    href="{{ printf $assets.katex.css.url $assets.katex.version }}"
    {{ with $assets.katex.css.sri }}
      integrity="{{ . }}"
    {{ end }}
    media="print"
    onload="this.media='all';this.onload=null"
    crossorigin
  />
  <script
    defer
    src="{{ printf $assets.katex.js.url $assets.katex.version }}"
    {{ with $assets.katex.js.sri }}
      integrity="{{ . }}"
    {{ end }}
    crossorigin
  ></script>
  <script
    defer
    src="{{ printf $assets.katex.autoRender.url $assets.katex.version }}"
    {{ with $assets.katex.autoRender.sri }}integrity="{{ . }}"{{ end }}
    crossorigin
  ></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
      {{- partial "utils/get-js-configs" .Site.Params.math.katex | safeJS }}
    });
  });
</script>
{{- end }}

{{/* Mermaid */}}
{{- if eq .Site.Params.diagram.handler "mermaid" }}
  <script
    defer
    src="{{ printf $assets.mermaid.js.url $assets.mermaid.version }}"
    {{ with $assets.mermaid.js.sri }}
      integrity="{{ . }}"
    {{ end }}
    crossorigin
  ></script>
  {{- with .Site.Params.diagram.mermaid }}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    mermaid.initialize({
      {{- partial "utils/get-js-configs" . | safeJS }}
    });
  });
</script>
  {{- end }}
{{- end }}

{{- if and .Site.GoogleAnalytics hugo.IsProduction }}
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin />
  <script
    async
    src="https://www.googletagmanager.com/gtag/js?id={{ .Site.GoogleAnalytics }}"
  ></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', '{{ .Site.GoogleAnalytics }}');
</script>
{{- end }}

{{- if .Site.Params.analytic.yandexMetrika }}
  <!-- Yandex.Metrika counter -->
<script
  type="text/javascript"> (function (m, e, t, r, i, k, a) { m[i] = m[i] || function () { (m[i].a = m[i].a || []).push(arguments) }; m[i].l = 1 * new Date(); k = e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a) })(window, document, "script", "https://mc.yandex.ru/metrika/tag.js?v2", "ym"); ym({{ .Site.Params.analytic.yandexMetrika }}, "init", { clickmap: true, trackLinks: true, accurateTrackBounce: true, webvisor: true }); </script>
  <noscript>
    <div>
      <img
        src="https://mc.yandex.ru/watch/{{ .Site.Params.analytic.yandexMetrika }}"
        style="position:absolute; left:-9999px;"
        alt=""
      />
    </div>
  </noscript>
  <!-- /Yandex.Metrika counter -->
{{- end }}

{{ partial "custom-head" . }}

{{- with .Site.Params.icon }}
  <link
    rel="icon"
    type="image/png"
    sizes="32x32"
    href="{{ (partial "get-icon" (dict "icon" . "size" 32)).Permalink }}"
  />
  <link
    rel="apple-touch-icon"
    sizes="180x180"
    href="{{ (partial "get-icon" (dict "icon" . "size" 180)).Permalink }}"
  />
{{- end }}

{{ define "partials/get-icon" }}
  {{ $icon := resources.GetMatch .icon }}
  {{ $iconResized := $icon.Fill (printf "%sx%s Center" (string .size) (string .size)) }}
  {{ return $iconResized }}
{{ end }}

{{- partial "components/schema" . }}
{{- partial "components/opengraph" . }}
{{- range .AlternativeOutputFormats }}
  {{- printf `
    <link rel="%s" type="%s" href="%s" title="%s" />` .Rel .MediaType.Type .Permalink $.Site.Title | safeHTML
  }}
{{- end }}
