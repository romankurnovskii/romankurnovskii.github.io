# Глава 39 - Python wheels

Первым распространенным форматом упаковки Python был файл .egg. Теперь в городе появился новый формат под названием **wheel** *(.whl). Согласно описанию в Python Packaging Index, wheel предназначен для содержания всех файлов для установки, совместимой с PEP 376, в формате, очень близком к формату на диске.* В этой главе мы узнаем, как создать wheel и затем установить его в **virtualenv**.

## Начало работы

Рекомендуемый способ работы с wheels - использование pip. Убедитесь, что вы установили последнюю версию pip, так как более ранние версии не поддерживают формат wheel. Если вы не уверены, что у вас установлена последняя версия pip, вы можете выполнить следующую команду:


```sh
pip install --upgrade pip
```

Если у вас нет последней версии, то эта команда обновит pip. Теперь мы готовы к созданию wheel!

## Создание wheel

Прежде всего, вам нужно установить пакет wheel:

```sh
pip install wheel
```

Это было легко! Далее мы будем использовать пакет **unidecode** для создания нашего первого wheel, так как на момент написания статьи он еще не был создан, и я сам использовал этот пакет в нескольких проектах. Пакет unidecode берет строку текста и пытается заменить любой юникод на его эквивалент ASCII. Это очень удобно, когда нужно очистить данные, предоставленные пользователем, от странных аномалий. Вот команда, которую нужно выполнить, чтобы создать wheel для этого пакета:

```sh
pip wheel --wheel-dir=my_wheels Unidecode
```

Вот скриншот вывода, который я получил при запуске этой программы:

![](wheel_creation.jpg)

Теперь у вас должно быть wheel с именем **Unidecode-0.04.14-py26-none-any.whl** в папке my_wheels. Давайте узнаем, как установить наше новое wheel!

## Установка wheel Python

Давайте создадим virtualenv для тестирования. Для создания виртуальной среды тестирования мы используем следующую команду:

```sh
virtualenv test
```

Это предполагает, что **virtualenv** находится в вашем системном пути. Если вы получите ошибку **unrecognized command**, то вам, вероятно, придется указать полный путь (например, **c:\Python34\Scripts\virtualenv**). Выполнение этой команды создаст для нас виртуальную песочницу, в которой будет работать pip. Обязательно запустите скрипт **activate** из папки Scripts папки **test**, чтобы включить virtuanenv, прежде чем продолжить. Ваш virtualenv не включает wheel, поэтому вам придется установить wheel снова:

```sh
pip install wheel
```

После этого мы можем установить наше wheel с помощью следующей команды:

```sh
pip install --use-wheel --no-index --find-links=path/to/my_wheels Unidecode
```

Чтобы проверить, что это сработало, запустите Python из папки Scripts в вашем виртуальном окружении и попробуйте импортировать unidecode. Если он импортируется, значит, вы успешно установили wheel!

Файл *.whl похож на *.egg тем, что это, по сути, замаскированный файл *.zip. Если вы переименуете расширение с *.whl на *.zip, вы сможете открыть его с помощью выбранного вами приложения zip и изучить файлы и папки внутри по своему усмотрению.

## Подведение итогов

Теперь вы должны быть готовы к созданию собственных wheels. Это хороший способ создать локальный репозиторий зависимостей для вашего проекта (проектов), который можно быстро установить. Вы можете создать несколько различных репозиториев wheel, чтобы легко переключаться между различными наборами версий для тестирования. В сочетании с virtualenv вы получаете действительно простой способ увидеть, как новые версии зависимостей могут повлиять на ваш проект, без необходимости загружать их несколько раз.
