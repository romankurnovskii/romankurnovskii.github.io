---
title: 2. Все о строках
description: Python 101
toc: true
authors:
tags:
categories:
series:
featuredImage:
date: "2022-06-28"
lastmod: "2022-06-28"
draft: false
weight: 2
---

В Python существует несколько типов данных. Основные типы данных, с которыми вы, вероятно, будете чаще всего встречаться, - это строка, целое число, плавающая цифра, список, словарь и кортеж. В этой главе мы рассмотрим строковый тип данных. Вы удивитесь, как много вещей можно делать со строками в Python прямо из коробки. Существует также модуль string, который можно импортировать для получения доступа к еще большей функциональности, но мы не будем рассматривать его в этой главе. Вместо этого мы рассмотрим следующие темы:

- Как создавать строки
- Конкатенация строк
- Методы работы со строками
- Нарезка строк
- Подстановка строк

## Как создать строку

Строки обычно создаются одним из трех способов. Вы можете использовать одинарные, двойные или тройные кавычки. Давайте посмотрим!

```sh
>>> my_string = "Welcome to Python!"
>>> another_string = 'The bright red fox jumped the fence.'
>>> a_long_string = '''This is a
multi-line string. It covers more than
one line'''
```
Строка с тройными кавычками может быть выполнена с помощью трех одинарных или трех двойных кавычек. В любом случае они позволяют программисту писать строки в несколько строк. Когда вы выведете ее, то заметите, что при выводе сохраняются разрывы строк. Если вам необходимо использовать одинарные кавычки в строке, то оберните их в двойные кавычки. Смотрите следующий пример.

```sh
>>> my_string = "I'm a Python programmer!"
>>> otherString = 'The word "python" usually refers to a snake'
>>> tripleString = """Here's another way to embed "quotes" in a string"""
```
Приведенный выше код демонстрирует, как можно поместить одинарные или двойные кавычки в строку. На самом деле существует еще один способ создания строки - это использование метода **str**. Вот как это работает:

```sh
>>> my_number = 123
>>> my_string = str(my_number)
```
Если вы введете приведенный выше код в свой интерпретатор, то обнаружите, что вы преобразовали целочисленное значение в строку и присвоили строку переменной *my_string*. Это известно как преобразование. Вы можете преобразовывать некоторые типы данных в другие типы данных, например, числа в строки. Но вы также увидите, что не всегда можно сделать обратное действие, например, преобразовать строку типа 'ABC' в целое число. В этом случае вы получите ошибку, подобную той, что приведена в следующем примере:

```sh
>>> int('ABC')
Traceback (most recent call last):
  File "<string>", line 1, in <fragment>
ValueError: invalid literal for int() with base 10: 'ABC'
```

Мы рассмотрим обработку исключений в следующей главе, но, как вы уже догадались из сообщения, это означает, что вы не можете преобразовать литерал в целое число. Однако, если бы вы сделали

```sh
>>> x = int("123")
```
тогда это будет работать нормально.

Следует отметить, что строка является одним из неизменяемых типов Python. Это значит, что вы не можете изменить содержимое строки после ее создания. Давайте попробуем изменить одну из них и посмотрим, что произойдет:

```sh
>>> my_string = "abc"
>>> my_string[0] = "d"
Traceback (most recent call last):
  File "<string>", line 1, in <fragment>
TypeError: 'str' object does not support item assignment
```
Здесь мы пытаемся изменить первый символ с "a" на "d", однако это вызывает ошибку типа TypeError, которая не дает нам этого сделать. Теперь вы можете подумать, что, присвоив новую строку той же переменной, вы изменили строку. Давайте проверим, так ли это:

```sh
>>> my_string = "abc"
>>> id(my_string)
19397208
>>> my_string = "def"
>>> id(my_string)
25558288
>>> my_string = my_string + "ghi"
>>> id(my_string)
31345312
```
Проверяя id объекта, мы можем определить, что каждый раз, когда мы присваиваем переменной новое значение, ее идентификатор меняется.

## Конкатенация строк

Конкатенация - это большое слово, которое означает объединение или сложение двух вещей вместе. В данном случае мы хотим узнать, как сложить две строки вместе. Как вы уже догадались, эта операция очень проста в Python:

```sh
>>> string_one = "My dog ate "
>>> string_two = "my homework!"
>>> string_three = string_one + string_two
```
Оператор '+' объединяет две строки в одну.

## Методы работы со строками

Строка - это объект в Python. Фактически, все в Python является объектом. Однако вы еще не готовы к этому. Если вы хотите узнать больше о том, что Python является объектно-ориентированным языком программирования, то вам нужно перейти к этой главе. А пока достаточно знать, что строки имеют свои собственные методы, встроенные в них. Например, допустим, у вас есть следующая строка:

```sh
>>> my_string = "This is a string!"
```
Теперь вы хотите, чтобы эта строка была полностью в верхнем регистре. Для этого достаточно вызвать его метод **upper()**, как показано ниже:

```sh
>>> my_string.upper()
```
Если у вас открыт интерпретатор, вы можете сделать то же самое следующим образом:

```sh
>>> "This is a string!".upper()
```
Существует множество других методов работы со строками. Например, если бы вы хотели, чтобы все было в нижнем регистре, вы бы использовали метод **lower()**. Если бы вы хотели удалить все пробелы в начале и в конце строки, вы бы использовали метод **strip()**. Чтобы получить список всех методов работы со строками, введите в интерпретатор следующую команду:

```sh
>>> dir(my_string)
```
В итоге вы должны увидеть нечто похожее на это:

[‘__add__’, ‘__class__’, ‘__contains__’, ‘__delattr__’, ‘__doc__’, ‘__eq__’, ‘__format__’, ‘__ge__’, ‘__getattribute__’, ‘__getitem__’, ‘__getnewargs__’, ‘__getslice__’, ‘__gt__’, ‘__hash__’, ‘__init__’, ‘__le__’, ‘__len__’, ‘__lt__’, ‘__mod__’, ‘__mul__’, ‘__ne__’, ‘__new__’, ‘__reduce__’, ‘__reduce_ex__’, ‘__repr__’, ‘__rmod__’, ‘__rmul__’, ‘__setattr__’, ‘__sizeof__’, ‘__str__’, ‘__subclasshook__’, ‘_formatter_field_name_split’, ‘_formatter_parser’, ‘capitalize’, ‘center’, ‘count’, ‘decode’, ‘encode’, ‘endswith’, ‘expandtabs’, ‘find’, ‘format’, ‘index’, ‘isalnum’, ‘isalpha’, ‘isdigit’, ‘islower’, ‘isspace’, ‘istitle’, ‘isupper’, ‘join’, ‘ljust’, ‘lower’, ‘lstrip’, ‘partition’, ‘replace’, ‘rfind’, ‘rindex’, ‘rjust’, ‘rpartition’, ‘rsplit’, ‘rstrip’, ‘split’, ‘splitlines’, ‘startswith’, ‘strip’, ‘swapcase’, ‘title’, ‘translate’, ‘upper’, ‘zfill’]

Вы можете смело игнорировать методы, начинающиеся и заканчивающиеся двойными знаками, такие как **__add__**. Они не используются в повседневном кодировании на Python. Вместо этого сосредоточьтесь на других методах. Если вы хотите узнать, что делает один из них, просто попросите **помощи**. Например, вы хотите узнать, для чего нужна **capitalize**. Чтобы узнать это, введите

```sh
>>> help(my_string.capitalize)
```

Это вернет следующую информацию:

```
Help on built-in function capitalize:

capitalize(...)
S.capitalize() -> string
```

Возвращает копию строки S, в которой заглавным является только первый символ.

Вы только что узнали немного о теме, называемой **интроспекцией**. Python позволяет легко проводить интроспекцию всех своих объектов, что делает его очень удобным в использовании. По сути, интроспекция позволяет вам спрашивать Python о самом себе. В одном из предыдущих разделов вы узнали о преобразовании. Возможно, вы задавались вопросом, как определить тип переменной (например, int или string). Вы можете попросить Python рассказать вам об этом!

```sh
>>> type(my_string)
    <type 'str'>
```

Как вы видите, переменная my_string имеет тип str!

## Нарезка строка

Один из пунктов, которым вы будете часто заниматься в реальном мире, - это нарезка строк. Я был удивлен, как часто мне приходилось сталкиваться с необходимостью знать, как это делается в моей повседневной работе. Давайте посмотрим, как работает нарезка на примере следующей строки:

```sh
>>> my_string = "I like Python!"
```

Каждый символ в строке может быть доступен с помощью нарезки. Например, если я хочу получить только первый символ, я могу сделать следующее:

```sh
>>> my_string[0:1]
```

Это захватит первый символ в строке до 2-го символа, но не включая его. Да, Python основан на нулях. Это будет немного проще понять, если мы обозначим позицию каждого символа в таблице:

0 |	1 |	2 |	3 |	4 |	5 |	6 |	7 |	8 |	9 |	10 | 11 |	12 | 13
I |	  |	l |	i |	k |	e |	  |	P |	y |	t |	 h |	o |	n  |	!

Таким образом, у нас есть строка длиной 14 символов, начинающаяся с нуля и заканчивающаяся тринадцатью. Давайте рассмотрим еще несколько примеров, чтобы лучше закрепить эти понятия в голове.

```sh
>>> my_string[:1]
'I'
>>> my_string[0:12]
'I like Pytho'
>>> my_string[0:13]
'I like Python'
>>> my_string[0:14]
'I like Python!'
>>> my_string[0:-5]
'I like Py'
>>> my_string[:]
'I like Python!'
>>> my_string[2:]
'like Python!'
```

Как видно из этих примеров, мы можем сделать срез, указав только начало среза (например, my_string[2:]), конец среза (например, my_string[:1]) или оба (например, my_string[0:13]). Мы можем даже использовать отрицательные значения, которые начинаются с конца строки. Так, в примере my_string[0:-5] начинается с нуля, но заканчивается за 5 символов до конца строки.

Вам может быть интересно, где можно использовать это. Я использую его для разбора записей фиксированной ширины в файлах или иногда для разбора сложных имен файлов, которые следуют очень специфическому соглашению об именовании. Я также использовал его при разборе значений из файлов двоичного типа. Любая работа, где вам нужно обрабатывать текстовые файлы, станет проще, если вы поймете, что такое нарезка и как ее эффективно использовать.

Вы также можете получить доступ к отдельным символам в строке с помощью индексации. Вот пример:

```sh
>>> print(my_string[0])
```

Приведенный выше код выведет первый символ в строке.

## Форматирование строк

Форматирование строк (оно же подстановка) - это тема подстановки значений в базовую строку. В большинстве случаев вы будете вставлять строки в строки, однако вам также часто придется вставлять в строки целые и плавающие числа. Существует два различных способа выполнения этой задачи. Мы начнем со старого способа, а затем перейдем к новому.

Старый способ подстановки строк

Самый простой способ узнать, как это делается, - посмотреть несколько примеров. Итак, приступим:

```sh
>>> my_string = "I like %s" % "Python"
>>> my_string
'I like Python'
>>> var = "cookies"
>>> newString = "I like %s" % var
>>> newString
'I like cookies'
>>> another_string = "I like %s and %s" % ("Python", var)
>>> another_string
'I like Python and cookies'
```

Как вы уже, наверное, догадались, **%s** - это важный элемент в приведенном выше коде. Он сообщает Python, что скоро вы можете вставить текст. Если за строкой следует знак процента и другая строка или переменная, Python попытается вставить ее в строку. Вы можете вставить несколько строк, поместив несколько экземпляров %s внутрь строки. Вы увидите это в последнем примере. Обратите внимание, что при вставке более одной строки необходимо заключить в круглые скобки те строки, которые вы собираетесь вставить.

Теперь давайте посмотрим, что произойдет, если мы вставим недостаточно строк:

```sh
Traceback (most recent call last):
  File "<string>", line 1, in <fragment>
TypeError: not enough arguments for format string
```

Упс! Мы не передали достаточно аргументов для форматирования строки! Если вы внимательно посмотрите на пример выше, то заметите, что в нем есть два экземпляра %s, поэтому, чтобы вставить в него строки, вы должны передать ему такое же количество строк! Теперь мы готовы узнать о вставке целых и плавающих чисел. Давайте посмотрим!

```sh
>>> my_string = "%i + %i = %i" % (1,2,3)
>>> my_string
'1 + 2 = 3'
>>> float_string = "%f" % (1.23)
>>> float_string
'1.230000'
>>> float_string2 = "%.2f" % (1.23)
>>> float_string2
'1.23'
>>> float_string3 = "%.2f" % (1.237)
>>> float_string3
'1.24'
```

Первый пример довольно очевиден. Мы создаем строку, которая принимает три аргумента, и передаем их. На всякий случай, если вы еще не поняли, нет, Python не выполняет никакого сложения в этом первом примере. Во втором примере мы передаем плавающее число. Обратите внимание, что на выходе получается много лишних нулей. Нам это не нужно, поэтому мы говорим Python ограничиться двумя знаками после запятой в третьем примере ("%.2f"). Последний пример показывает, что Python сделает округление за вас, если вы передадите ему плавающее число с более чем двумя знаками после запятой.

Теперь давайте посмотрим, что произойдет, если мы передадим ему плохие данные:

```sh
>>> int_float_err = "%i + %f" % ("1", "2.00")
Traceback (most recent call last):
  File "<string>", line 1, in <fragment>
TypeError: %d format: a number is required, not str
```
В этом примере мы передаем ему две строки вместо целого и плавающего числа. Это вызывает ошибку TypeError и говорит нам, что Python ожидал получить число. Это относится к тому, что мы не передали целое число, поэтому давайте исправим это и посмотрим, устранит ли это проблему:

```sh
>>> int_float_err = "%i + %f" % (1, "2.00")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: must be real number, not str
```
Неа. Мы получаем ту же ошибку, но другое сообщение, которое говорит нам, что мы должны были передать плавающее число. Как видите, Python дает нам довольно хорошую информацию о том, что пошло не так и как это исправить. Если вы правильно исправите входные данные, то сможете запустить этот пример.

Давайте перейдем к новому методу форматирования строк!

**Шаблоны и новая методика форматирования строк**

Этот новый метод был фактически добавлен еще в Python 2.4 в виде шаблонов строк, но в Python 2.6 он был добавлен как обычный метод форматирования строк через метод **format**. Так что это не совсем новый метод, просто более новый. В любом случае давайте начнем с шаблонов!

```sh
>>> print("%(lang)s is fun!" % {"lang":"Python"})
Python is fun!
```

Возможно, это выглядит довольно странно, но, по сути, мы просто заменили %s на %(lang)s, что, является %s с переменной внутри. Вторая часть на самом деле называется словарем Python, который мы будем изучать в следующем разделе. По сути, это пара ключ:значение, поэтому когда Python видит ключ "lang" в строке И в ключе переданного словаря, он заменяет этот ключ на его значение. Давайте рассмотрим еще несколько примеров:

```sh
>>> print("%(value)s %(value)s %(value)s !" % {"value":"SPAM"})
SPAM SPAM SPAM !

>>> print("%(x)i + %(y)i = %(z)i" % {"x":1, "y":2})
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'z'

>>> print("%(x)i + %(y)i = %(z)i" % {"x":1, "y":2, "z":3})
1 + 2 = 3
```

В первом примере вы заметите, что мы передали только одно значение, но оно было вставлено 3 раза! Это одно из преимуществ использования шаблонов. Во втором примере есть проблема, связанная с тем, что мы забыли передать ключ, а именно ключ "z". Третий пример исправляет эту проблему и показывает результат. Теперь давайте посмотрим, как можно сделать нечто подобное с помощью метода формата строки!

```sh
>>> "Python is as simple as {0}, {1}, {2}".format("a", "b", "c")
'Python is as simple as a, b, c'

>>> "Python is as simple as {1}, {0}, {2}".format("a", "b", "c")
'Python is as simple as b, a, c'

>>> xy = {"x":0, "y":10}

>>> print("Graph a point at where x={x} and y={y}".format(**xy))
Graph a point at where x=0 and y=10
```

В первых двух примерах вы можете видеть, как мы можем передавать элементы позиционно. Если мы изменим порядок, то получим немного другой результат. В последнем примере используется словарь, как мы использовали в шаблонах выше. Однако нам нужно извлечь словарь с помощью двойной звездочки, чтобы он работал правильно.

Есть много других вещей, которые можно делать со строками, например, указывать ширину, выравнивать текст, конвертировать в различные базы и многое другое. Обязательно посмотрите некоторые из приведенных ниже ссылок для получения дополнительной информации.

- [Официальная документация Python по типу str](https://docs.python.org/3/library/functions.html#func-str)
- [Форматирование строк](https://docs.python.org/3/library/string.html#string-formatting)
- [Подробнее о форматировании строк(https://docs.python.org/3/library/string.html#formatexamples)

## Подведение итогов

Мы многое рассмотрели в этой главе. Давайте подведем итоги:

Сначала мы узнали, как создавать сами строки, затем перешли к теме конкатенации строк. После этого мы рассмотрели некоторые методы, которые предоставляет нам объект string. Далее мы рассмотрели нарезку строк и закончили изучением подстановки строк.

В следующей главе мы рассмотрим еще три встроенных типа данных Python: списки, кортежи и словари. Приступаем!
